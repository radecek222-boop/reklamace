<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Protokol - White Glove Service</title>
  <style>
    body {
      font-family: Inter, sans-serif;
      background:#f6f7fb;
      margin:0;
      padding:20px;
      font-size:12px;
      display:flex;
      justify-content:center;
    }
    .wrapper {
      width:100%;
      max-width:900px;
      background:white;
      padding:20px;
      box-shadow:0 0 10px rgba(0,0,0,0.1);
    }
    .header { text-align:center; margin-bottom:20px; }
    .header div:first-child { font-size:28px; font-weight:900; }
    .header div:last-child { font-size:12px; margin-top:4px; font-weight:normal; }
    table { width:100%; border-collapse:collapse; margin:10px 0; }
    td { padding:6px; vertical-align:top; }
    .label { font-weight:600; width:40%; }
    input, select, textarea { width:100%; padding:4px; font-size:1em; }
    .split-section { display:flex; gap:10px; margin:10px 0; }
    .two-col-table { display:flex; gap:30px; flex-wrap:wrap; }
    .two-col-table .col { flex:1; min-width:300px; }
    .section-title { font-weight:700; margin-top:20px; }
    #signature-pad {
      border:2px dashed #888;
      width:100%;
      height:150px;
      background:white;
    }
    .signature-label { font-size:0.9em; color:#444; margin:4px 0 20px; }
    .btns { margin-top:20px; display:flex; gap:10px; flex-wrap:wrap; }
    .btns button { padding:10px 20px; font-size:1em; border:none; background:#333; color:white; border-radius:6px; cursor:pointer; }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.6/dist/signature_pad.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
<div class="wrapper">
  <div class="header">
    <div>WHITE GLOVE SERVICE</div>
    <div>Do Dubƒçe 364, Bƒõchovice 190 11 ¬∑ +420 725 965 826 ¬∑ reklamace-wgs@email.cz ¬∑ IƒåO: 09769684</div>
  </div>

  <div class="two-col-table">
    <div class="col">
      <table>
        <tr><td class="label">ƒå√≠slo objedn√°vky</td><td><input id="order-number"></td></tr>
        <tr><td class="label">ƒå√≠slo reklamace</td><td><input id="claim-number"></td></tr>
        <tr><td class="label">Z√°kazn√≠k</td><td><input id="customer"></td></tr>
        <tr><td class="label">Adresa z√°kazn√≠ka</td><td><input id="address"></td></tr>
        <tr><td class="label">Znaƒçka / Contract</td><td><input id="brand"></td></tr>
        <tr><td class="label">Model</td><td><input id="model"></td></tr>
      </table>
    </div>
    <div class="col">
      <table>
        <tr><td class="label">Technik</td><td><select id="technician"><option>Milan Kol√≠n</option><option>Radek Zikmund</option><option>Kol√≠n/Zikmund</option></select></td></tr>
        <tr><td class="label">Datum n√°v≈°tƒõvy</td><td><input id="visit-date" type="date"></td></tr>
        <tr><td class="label">Datum doruƒçen√≠</td><td><input id="delivery-date" type="date"></td></tr>
        <tr><td class="label">Datum pod√°n√≠ reklamace</td><td><input id="claim-date" type="date"></td></tr>
      </table>
    </div>
  </div>

  <div class="section-title">Z√°kazn√≠k reklamuje / Customer complaint</div>
  <div class="split-section">
    <textarea id="description-cz" placeholder="CZ"></textarea>
    <textarea id="description-en" placeholder="EN"></textarea>
  </div>
  <div class="section-title">Probl√©m zji≈°tƒõn√Ω technikem / Detected problem</div>
  <div class="split-section">
    <textarea id="problem-cz" placeholder="CZ"></textarea>
    <textarea id="problem-en" placeholder="EN"></textarea>
  </div>
  <div class="section-title">N√°vrh opravy / Repair proposal</div>
  <div class="split-section">
    <textarea id="repair-cz" placeholder="CZ"></textarea>
    <textarea id="repair-en" placeholder="EN"></textarea>
  </div>

  <div class="two-col-table">
    <div class="col">
      <table>
        <tr><td class="label">Poƒçet opravovan√Ωch d√≠l≈Ø</td><td><input id="parts"></td></tr>
        <tr><td class="label">Cena za pr√°ci</td><td><input id="price-work"></td></tr>
        <tr><td class="label">Cena za materi√°l</td><td><input id="price-material"></td></tr>
        <tr><td class="label">Cena za druh√©ho technika</td><td><input id="price-second"></td></tr>
        <tr><td class="label">Cena za dopravu</td><td><input id="price-transport"></td></tr>
        <tr><td class="label">Cena celkem</td><td><input id="price-total"></td></tr>
      </table>
    </div>
    <div class="col">
      <table>
        <tr><td class="label">Reklamace vy≈ôe≈°ena?</td><td><select id="solved"><option>ANO</option><option>NE</option></select></td></tr>
        <tr><td class="label">ƒåek√° se na vyj√°d≈ôen√≠ prodejce?</td><td><select id="dealer"><option>NE</option><option>ANO</option></select></td></tr>
        <tr><td class="label">Po≈°kozen√≠ technikem?</td><td><select id="damage"><option>NE</option><option>ANO</option></select></td></tr>
        <tr><td class="label">√öhradu provede z√°kazn√≠k?</td><td><select id="payment"><option>NE</option><option>ANO</option></select></td></tr>
        <tr><td class="label">Datum podpisu</td><td><input id="sign-date" type="date"></td></tr>
      </table>
    </div>
  </div>

  <div class="section-title">Podpis z√°kazn√≠ka</div>
  <canvas id="signature-pad"></canvas>

  <div class="btns">
    <button onclick="signaturePad.clear()">üóëÔ∏è Vymazat podpis</button>
    <button onclick="window.location.href='index.html'">‚¨ÖÔ∏è Zpƒõt</button>
    <button onclick="downloadPDF()">üìÑ Exportovat do PDF</button>
  </div>
</div>

<script>
  let signaturePad;
  window.addEventListener("DOMContentLoaded", () => {
    const canvas = document.getElementById("signature-pad");
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    signaturePad = new SignaturePad(canvas);
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("visit-date").value = today;
    document.getElementById("sign-date").value = today;
  });

  function downloadPDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF("p","mm","a4");

    doc.setFont("times","normal"); // ‚úÖ Times podporuje ƒçeskou diakritiku

    // Hlaviƒçka
    doc.setFontSize(16);
    doc.text("WHITE GLOVE SERVICE",105,15,{align:"center"});
    doc.setFontSize(10);
    doc.text("Do Dubƒçe 364, Bƒõchovice 190 11 ¬∑ +420 725 965 826 ¬∑ reklamace-wgs@email.cz ¬∑ IƒåO: 09769684",105,22,{align:"center"});

    // √ödaje z√°kazn√≠k/technik
    doc.autoTable({
      startY:30,
      theme:"grid",
      styles:{font:"times",fontSize:10},
      headStyles:{fillColor:[255,255,255], textColor:[0,0,0]},
      head:[["ƒå√≠slo objedn√°vky",document.getElementById("order-number").value,"Technik",document.getElementById("technician").value]],
      body:[
        ["ƒå√≠slo reklamace",document.getElementById("claim-number").value,"Datum n√°v≈°tƒõvy",document.getElementById("visit-date").value],
        ["Z√°kazn√≠k",document.getElementById("customer").value,"Datum doruƒçen√≠",document.getElementById("delivery-date").value],
        ["Adresa z√°kazn√≠ka",document.getElementById("address").value,"Datum pod√°n√≠ reklamace",document.getElementById("claim-date").value],
        ["Znaƒçka / Contract",document.getElementById("brand").value,"Model",document.getElementById("model").value]
      ],
      columnStyles:{0:{cellWidth:40},1:{cellWidth:55},2:{cellWidth:40},3:{cellWidth:55}}
    });

    // Complaint/problem/repair bloky
    function block(title,cz,en){
      doc.autoTable({
        startY:doc.lastAutoTable.finalY+10,
        theme:"grid",
        styles:{font:"times",fontSize:10,cellPadding:2,valign:"top"},
        headStyles:{fillColor:[255,255,255], textColor:[0,0,0]},
        head:[[title,""]],
        body:[
          ["CZ",document.getElementById(cz).value],
          ["EN",document.getElementById(en).value]
        ],
        columnStyles:{0:{cellWidth:20,fontStyle:"bold"},1:{cellWidth:170}}
      });
    }
    block("Z√°kazn√≠k reklamuje / Customer complaint","description-cz","description-en");
    block("Probl√©m zji≈°tƒõn√Ω technikem / Detected problem","problem-cz","problem-en");
    block("N√°vrh opravy / Repair proposal","repair-cz","repair-en");

    // Finance a stav
    doc.autoTable({
      startY:doc.lastAutoTable.finalY+10,
      theme:"grid",
      styles:{font:"times",fontSize:10},
      headStyles:{fillColor:[255,255,255], textColor:[0,0,0]},
      head:[["Finanƒçn√≠ √∫daje","","Stav reklamace",""]],
      body:[
        ["Poƒçet d√≠l≈Ø",document.getElementById("parts").value,"Vy≈ôe≈°eno",document.getElementById("solved").value],
        ["Pr√°ce",document.getElementById("price-work").value,"Vyj√°d≈ôen√≠ prodejce",document.getElementById("dealer").value],
        ["Materi√°l",document.getElementById("price-material").value,"Po≈°kozen√≠ technikem",document.getElementById("damage").value],
        ["2. technik",document.getElementById("price-second").value,"√öhrada z√°kazn√≠k",document.getElementById("payment").value],
        ["Doprava",document.getElementById("price-transport").value,"Datum podpisu",document.getElementById("sign-date").value],
        ["Celkem",document.getElementById("price-total").value,"",""]
      ],
      columnStyles:{0:{cellWidth:40},1:{cellWidth:55},2:{cellWidth:40},3:{cellWidth:55}}
    });

    // Podpis
    let y = doc.lastAutoTable.finalY+20;
    doc.setFont("times","bold"); doc.setFontSize(11);
    doc.text("Podpis z√°kazn√≠ka:",10,y);
    if(signaturePad && !signaturePad.isEmpty()){
      const signData = signaturePad.toDataURL();
      doc.addImage(signData,"PNG",50,y-10,60,20);
    }

    doc.save("protokol.pdf");
  }
</script>
</body>
</html>
