<!-- 
====================================================================
üíé WHITE GLOVE SERVICE ‚Äì AUDIT SYSTEM v6.2 (kompletn√≠ verze)
====================================================================
Autor: Radek Zikmund & Hugo (GPT-5)
Datum: 2025-10-13
Popis:
  ‚Äì Kompletn√≠ tmav√© rozhran√≠
  ‚Äì Automatick√° kontrola HTML, JS, CSS struktur
  ‚Äì AI n√°vrhy oprav + p≈ôehledn√© shrnut√≠ v√Ωsledk≈Ø
====================================================================
-->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Audit ‚Äì White Glove Service</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
/* üåë Tmav√© pozad√≠ + neonov√© zv√Ωraznƒõn√≠ */
body{
  font-family:"Inter",sans-serif;
  background:radial-gradient(circle at center,#0b0b0b 0%,#111 70%);
  margin:0;padding:0;color:#eaeaea;
}
header,footer,#logPanel,#previewPanel{
  background:#1b1b1b;color:#eee;
}
header{
  box-shadow:0 2px 6px rgba(0,0,0,0.6);
  padding:14px 20px 10px;
  border-bottom:1px solid #222;
  position:sticky;top:0;z-index:100;
  display:flex;flex-direction:column;align-items:flex-start;
}
.header-top{text-align:center;width:100%;margin-bottom:10px;}
header h1{margin:0;font-size:1.3em;font-weight:900;color:#00ff9c;}
.header-controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
button,a.btn{
  padding:8px 20px;border:none;border-radius:8px;font-weight:600;cursor:pointer;
  color:#fff;font-family:"Inter",sans-serif;font-size:0.9em;
  box-shadow:0 2px 6px rgba(0,255,150,0.25);
  transition:transform .15s ease,opacity .25s;text-decoration:none;
}
button:hover,a.btn:hover{transform:scale(1.04);opacity:.9;}
.btn-back{background:linear-gradient(135deg,#666,#999);}
.btn-console{background:linear-gradient(135deg,#1976d2,#2196f3);}
.btn-fix{background:linear-gradient(135deg,#e53935,#ff7043);}
.select-wrap{position:relative;}
.select-wrap::after{
  content:"‚ñº";position:absolute;right:12px;top:50%;
  transform:translateY(-50%);color:#aaa;font-size:0.7em;pointer-events:none;
}
select{
  appearance:none;-webkit-appearance:none;
  padding:8px 36px 8px 14px;border-radius:8px;border:1px solid #333;
  background:#0e0e0e;font-family:"Inter",sans-serif;font-weight:600;
  cursor:pointer;min-width:160px;font-size:0.9em;color:#eee;
}
select:focus{outline:none;border-color:#00ff9c;box-shadow:0 0 0 2px rgba(0,255,140,0.2);}
main{
  display:flex;flex-direction:row;gap:10px;
  height:calc(100vh - 90px);overflow:hidden;padding:10px;
}
#logPanel{
  flex:0 0 40%;border-radius:10px;overflow:auto;
  box-shadow:0 0 12px rgba(0,0,0,0.5);
  padding:10px;font-size:0.9em;border:1px solid #333;
}
#previewPanel{
  flex:1;border-radius:10px;overflow:hidden;
  box-shadow:0 0 12px rgba(0,0,0,0.5);
  display:flex;flex-direction:column;border:1px solid #333;
}
iframe{flex:1;width:100%;border:none;background:#0e0e0e;}
.log{margin:4px 0;padding:6px 8px;border-left:4px solid transparent;line-height:1.4;}
.log.info{border-color:#00c853;}
.log.warn{border-color:#ffb300;background:rgba(255,179,0,0.08);}
.log.error{border-color:#e53935;background:rgba(229,57,53,0.1);}
footer{
  background:#0e0e0e;text-align:center;padding:8px;font-size:12px;
  border-top:1px solid #222;color:#777;
}
.hidden{display:none!important;}
@media(max-width:768px){
  main{flex-direction:column;}
  #logPanel{flex:1 1 50%;max-height:45vh;}
  #previewPanel{flex:1 1 50%;max-height:55vh;margin-top:8px;}
}
</style>
</head>

<body>
<header>
  <div class="header-top">
    <h1>WHITE GLOVE SERVICE ‚Äì AUDIT SYSTEM v6.2</h1>
  </div>
  <div class="header-controls">
    <a href="index.html" class="btn btn-back">Zpƒõt</a>
    <button id="consoleBtn" class="btn btn-console">Konzole</button>
    <button id="fixBtn" class="btn btn-fix">N√°vrh&nbsp;oprav</button>
    <div class="select-wrap">
      <select id="pageSelect">
        <option value="index.html">index.html</option>
        <option value="seznam.html">seznam.html</option>
        <option value="orders.html">orders.html</option>
        <option value="hotove.html">hotove.html</option>
        <option value="photocustomer.html">photocustomer.html</option>
        <option value="protokol.html">protokol.html</option>
      </select>
    </div>
  </div>
</header>

<main>
  <div id="logPanel"></div>
  <div id="previewPanel">
    <iframe id="auditFrame" sandbox="allow-scripts allow-same-origin"></iframe>
  </div>
</main>

<footer>¬© White Glove Service s.r.o. ‚Äì Audit System v6.2</footer>

<script>
// üü© Inicializace
const frame=document.getElementById("auditFrame");
const logPanel=document.getElementById("logPanel");
const pageSelect=document.getElementById("pageSelect");

// üßæ Logovac√≠ funkce
function log(type,msg,hint=""){
  const div=document.createElement("div");
  div.className=`log ${type}`;
  div.innerHTML=`<b>${type.toUpperCase()}</b> ${msg}`;
  if(hint){
    const h=document.createElement("div");
    h.style.fontSize="0.85em";h.style.color="#ccc";h.textContent="üí° "+hint;
    div.appendChild(h);
  }
  logPanel.appendChild(div);
  logPanel.scrollTop=logPanel.scrollHeight;
}

// üü® Naƒçten√≠ str√°nky
function runAudit(){
  const file=pageSelect.value;
  logPanel.innerHTML="";
  frame.src=file+"?"+Date.now();
  log("info",`üîç Naƒç√≠t√°m str√°nku: ${file}`);
}

// üü¶ Po naƒçten√≠ v iframe
frame.addEventListener("load",()=>{
  const win=frame.contentWindow,doc=frame.contentDocument;
  log("info","‚úÖ Str√°nka naƒçtena.");

  win.addEventListener("error",e=>log("error",e.message,"Zkontroluj element nebo po≈ôad√≠ skript≈Ø."));
  win.addEventListener("unhandledrejection",e=>log("error","Promise: "+e.reason,"Chyb√≠ await nebo .catch()."));

  const orig=win.console.log;
  win.console.log=(...a)=>{orig(...a);log("info",a.join(" "));};

  const expected=["#search","#tableContainer","#planModal","#calendarContainer","#mapContainer"];
  expected.forEach(sel=>{
    if(!doc.querySelector(sel))
      log("warn",`Chyb√≠ ${sel}`,"Dopl≈à do HTML nebo uprav JS vol√°n√≠.");
    else log("info",`‚úî Nalezen prvek ${sel}`);
  });

  drawFunctionGraph(win);
  deepAudit(win,doc);
  setTimeout(securityAudit,3000);
});
pageSelect.addEventListener("change",runAudit);
window.addEventListener("DOMContentLoaded",runAudit);

// üß≠ Vizualizace funkc√≠
function drawFunctionGraph(win){
  const f=Object.keys(win).filter(k=>typeof win[k]==="function").slice(0,40);
  if(!f.length){log("warn","Nenalezeny ≈æ√°dn√© funkce.");return;}
  const c=document.createElement("canvas");c.width=800;c.height=500;
  c.style.display="block";c.style.margin="10px auto";c.style.background="#0e0e0e";
  const ctx=c.getContext("2d");ctx.font="12px Inter";ctx.textAlign="center";
  f.forEach((fn,i)=>{const x=70+(i%10)*70,y=70+Math.floor(i/10)*70;
    ctx.beginPath();ctx.arc(x,y,25,0,2*Math.PI);ctx.fillStyle="#00c853";ctx.fill();
    ctx.fillStyle="#000";ctx.fillText(fn.slice(0,6),x,y+4);});
  log("info",`üß† Vykresleno ${f.length} funkc√≠.`);
  logPanel.appendChild(c);
}

// üîí Bezpeƒçnostn√≠ audit
async function securityAudit(){
  log("info","üîê Kontroluji knihovny...");
  const scripts=[...document.scripts].map(s=>s.src).filter(Boolean);
  scripts.forEach(s=>{
    if(s.startsWith("http://"))log("warn",`Nezabezpeƒçen√Ω skript: ${s}`,"Pou≈æij HTTPS.");
  });
  log("info",`üì¶ Nalezeno ${scripts.length} skript≈Ø.`);
}

// üß© Hlub≈°√≠ kontrola DOM
function deepAudit(win,doc){
  log("info","üîé Kontrola DOM...");
  const ids=["search","calendarContainer","mapContainer","planModal"];
  ids.forEach(id=>{
    if(!doc.querySelector("#"+id))log("warn",`Chyb√≠ #${id}`);
  });
  if(!doc.querySelectorAll("script").length)
    log("error","Na str√°nce nejsou ≈æ√°dn√© skripty!");
}

// üßæ Shrnut√≠ auditu
function summaryAudit(){
  const logs=[...document.querySelectorAll(".log")];
  const info=logs.filter(l=>l.classList.contains("info")).length;
  const warn=logs.filter(l=>l.classList.contains("warn")).length;
  const err=logs.filter(l=>l.classList.contains("error")).length;
  const scripts=document.querySelectorAll("script[src]").length;
  log("info",`üìä Shrnut√≠ auditu: ${info} info, ${warn} varov√°n√≠, ${err} chyb.`);
  log(err>0?"error":"info",err>0?`‚ùå Nutn√© opravy (${err}).`:"‚úÖ Bez kritick√Ωch chyb.");
  log("info",`üìö Naƒçten√Ωch skript≈Ø: ${scripts}`);
}
setInterval(summaryAudit,7000); // pravidelnƒõ obnovuje shrnut√≠

// √övodn√≠ logy
log("info","Audit System v6.2 inicializov√°n.");
log("info","Vyber str√°nku z menu pro spu≈°tƒõn√≠ auditu.");
</script>
</body>
</html>
<!-- üü© KONEC AUDIT SYSTEM v6.2 -->
