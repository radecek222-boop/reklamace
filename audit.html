<!-- 
=========================================================
üíé WHITE GLOVE SERVICE ‚Äì AUDIT SYSTEM (v4.1)
=========================================================
Autor: Radek Zikmund & Hugo (GPT-5)
Datum: 2025-10-12
Popis:
  Vizu√°ln√≠ diagnostika a kontrola WGS str√°nek.
  ‚Äì Logy a chyby v lev√©m panelu
  ‚Äì ≈Ωiv√Ω n√°hled str√°nky vpravo
  ‚Äì Zv√Ωraznƒõn√≠ chybƒõj√≠c√≠ch prvk≈Ø
=========================================================
-->

<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Audit ‚Äì White Glove Service</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
body{font-family:"Inter",sans-serif;margin:0;display:flex;flex-direction:column;height:100vh;background:#f6f7fb;color:#222;}
header{background:#fff;padding:10px 20px;box-shadow:0 2px 6px rgba(0,0,0,.1);display:flex;align-items:center;gap:10px;z-index:5;}
header img{height:36px;margin-right:8px;}
header strong{font-weight:900;font-size:18px;}
select,button{padding:8px 12px;border:1px solid #ccc;border-radius:6px;font-family:inherit;background:#f9f9f9;cursor:pointer;}
select:focus,button:focus{outline:none;border-color:#999;}
main{display:flex;flex:1;overflow:hidden;}
#logs{width:40%;background:#fff;overflow:auto;padding:12px;font-size:13px;line-height:1.4;border-right:2px solid #e0e0e0;}
#preview{flex:1;position:relative;background:#fafafa;}
iframe{width:100%;height:100%;border:none;background:#fff;}
.log{margin:3px 0;padding:5px 7px;border-left:4px solid transparent;cursor:pointer;}
.log.info{border-color:#2196f3;color:#222;}
.log.warn{border-color:#ffa000;background:#fff8e1;}
.log.error{border-color:#e53935;background:#ffebee;}
.highlight{outline:3px solid red;outline-offset:-3px;transition:all .2s ease;}
#suggestion{display:none;background:#eef;padding:4px;border-left:3px solid #2196f3;margin-top:4px;font-size:12px;}
footer{background:#fff;text-align:center;padding:6px 10px;font-size:12px;border-top:1px solid #eee;color:#666;}
</style>
</head>
<body>

<header>
  <img src="https://raw.githubusercontent.com/radecek222-boop/reklamace/main/logo-wgs.png" alt="WGS logo" onerror="this.style.display='none'">
  <strong>WHITE GLOVE SERVICE ‚Äì AUDIT</strong>
  <select id="pageSelect">
    <option>index.html</option>
    <option>seznam.html</option>
    <option>orders.html</option>
    <option>protokol.html</option>
    <option>photocustomer.html</option>
  </select>
  <button id="runBtn">Spustit audit</button>
</header>

<main>
  <div id="logs"></div>
  <div id="preview">
    <iframe id="frame" sandbox="allow-scripts allow-same-origin"></iframe>
  </div>
</main>

<footer>¬© White Glove Service s.r.o. ‚Äì vizu√°ln√≠ auditn√≠ panel v4.1</footer>

<script>
const logBox=document.getElementById("logs");
const frame=document.getElementById("frame");

function log(type,msg,selector="",hint=""){
  const div=document.createElement("div");
  div.className=`log ${type}`;
  div.innerHTML=`<b>${type.toUpperCase()}</b> ${msg}`;
  if(hint){
    const sug=document.createElement("div");
    sug.id="suggestion";
    sug.innerHTML=`üí° ${hint}`;
    div.appendChild(sug);
    div.onclick=()=>sug.style.display=sug.style.display==="block"?"none":"block";
  }
  if(selector){
    div.addEventListener("mouseover",()=>highlight(selector));
    div.addEventListener("mouseout",clearHighlight);
  }
  logBox.appendChild(div);
  logBox.scrollTop=logBox.scrollHeight;
}

function highlight(sel){
  try{const el=frame.contentDocument.querySelector(sel);if(el)el.classList.add("highlight");}catch{}
}
function clearHighlight(){frame.contentDocument.querySelectorAll(".highlight").forEach(el=>el.classList.remove("highlight"));}

document.getElementById("runBtn").onclick=()=>{
  logBox.innerHTML="";
  const file=document.getElementById("pageSelect").value;
  frame.src=file;
  log("info",`Naƒç√≠t√°m str√°nku: ${file}`);
  frame.onload=()=>{
    const win=frame.contentWindow;
    log("info",`‚úÖ Naƒçteno: ${file}`);
    win.addEventListener("error",e=>{
      log("error",`${e.message} (≈ô√°dek ${e.lineno})`,"","Zkontroluj chybƒõj√≠c√≠ element nebo po≈ôad√≠ skript≈Ø.");
    });
    win.addEventListener("unhandledrejection",e=>{
      log("error",`Promise: ${e.reason}`);
    });
    win.eval("(" + auditCore.toString() + ")()");
  };
};

function auditCore(){
  (async()=>{
    const ids=["searchInput","tableContainer","calendarContainer","mapContainer","planModal","signatureCanvas","uploadSection"];
    ids.forEach(id=>{
      const el=document.getElementById(id);
      if(!el) parent.log("warn",`Chyb√≠ #${id}`,"#"+id,"Dopl≈à element nebo uprav JS, kter√Ω ho pou≈æ√≠v√°.");
      else parent.log("info",`#${id} nalezen`);
    });
    const fns=Object.keys(window).filter(k=>typeof window[k]==="function");
    if(!window.loadData) parent.log("warn","Funkce loadData nenalezena","","Ovƒõ≈ô, ≈æe je JS naƒçten d≈ô√≠v ne≈æ se vol√°.");
    parent.log("info",`üîß Naƒçteno ${fns.length} funkc√≠.`);
  })();
}
</script>

</body>
</html>
