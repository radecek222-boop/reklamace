<!doctype html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WHITE GLOVE SERVICE – Hotové reklamace</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root { font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif; color:#111; }
body { margin:0; padding:20px; background:#f6f7fb; }
h1 { text-align:center; font-size:2em; font-weight:900; margin:0 0 10px; }
h2 { text-align:center; font-size:1.1em; font-weight:600; margin:0 0 20px; color:#555; }

.btn-gradient {
  display:inline-block; text-decoration:none; padding:10px 22px; border-radius:8px;
  font-weight:600; font-size:1em; color:#fff; border:none; cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,0.15);
  transition:transform 0.15s ease-in-out, opacity 0.2s; margin:4px;
}
.btn-gradient:hover { transform:scale(1.04); opacity:0.9; }
.btn-gray { background:linear-gradient(135deg,#6c757d,#a0a4a7); }
.btn-blue { background:linear-gradient(135deg,#0046ff,#357aff); }

.top-actions { text-align:center; margin-bottom:20px; }
.searchbox {
  width:100%; max-width:400px; margin:0 auto 20px; display:block;
  padding:10px; border:1px solid #ccc; border-radius:8px; font-size:1em; background:#fff;
}

table { width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; }
th, td { padding:10px 12px; text-align:left; border-bottom:1px solid #ddd; font-size:0.95em; vertical-align:middle; }
th { background:#eee; font-weight:700; }
tr:hover { background:#f1f3f5; cursor:pointer; }

.icon-phone { color:#00b36b; }
.icon-waze { color:#357aff; }

a.link-icon { text-decoration:none; color:inherit; font-weight:500; display:flex; align-items:center; gap:5px; }
a.link-icon:hover { opacity:0.8; }

.action-btn {
  background:linear-gradient(135deg,#00b36b,#3cd67a);
  color:white; border:none; border-radius:6px; padding:6px 12px;
  cursor:pointer; font-weight:600; font-size:0.85em; display:flex; align-items:center; gap:6px;
  justify-content:center;
}
.action-btn:hover { opacity:0.9; }

@media (max-width:768px){ th:nth-child(n+5), td:nth-child(n+5){display:none;} }
</style>
</head>
<body>
<h1>WHITE GLOVE SERVICE</h1>
<h2>Hotové reklamace</h2>

<div class="top-actions">
  <a href="index.html" class="btn-gradient btn-gray"><i class="fa-solid fa-house"></i> Zpět na hlavní stránku</a>
  <a href="seznam.html" class="btn-gradient btn-blue"><i class="fa-solid fa-list"></i> Zpět na seznam</a>
</div>

<input type="text" id="searchInput" class="searchbox" placeholder="Hledat podle jména, adresy nebo telefonu...">

<table id="dataTable">
<thead>
<tr><th>JMÉNO</th><th>ADRESA</th><th>TELEFON</th><th>STAV</th><th>AKCE</th></tr>
</thead>
<tbody id="tableBody"><tr><td colspan="5" style="text-align:center;padding:20px;">Načítání dat...</td></tr></tbody>
</table>

<script>
const GITHUB_USER="radecek222-boop", REPO="reklamace";
const FILE="hotove.json";

async function loadHotove(){
  document.getElementById("tableBody").innerHTML="<tr><td colspan='5' style='text-align:center;padding:20px;'>Načítání...</td></tr>";
  try{
    const res=await fetch(`https://raw.githubusercontent.com/${GITHUB_USER}/${REPO}/main/${FILE}?${Date.now()}`);
    const data=await res.json();
    renderTable(data);
  }catch(e){
    document.getElementById("tableBody").innerHTML=`<tr><td colspan='5' style='text-align:center;color:red;'>Chyba: ${e.message}</td></tr>`;
  }
}

function renderTable(data){
  const tbody=document.getElementById("tableBody");tbody.innerHTML="";
  const query=document.getElementById("searchInput").value.toLowerCase();
  data.filter(x=>{
    return !query || (x["Zákazník"]||"").toLowerCase().includes(query)
    || (x["Adresa"]||"").toLowerCase().includes(query)
    || (x["Telefon"]||"").toLowerCase().includes(query);
  }).forEach((item)=>{
    const tr=document.createElement("tr");
    const addr=item["Adresa"]?`<a class="link-icon" href="https://waze.com/ul?ll=&q=${encodeURIComponent(item["Adresa"])}" target="_blank"><i class='fa-brands fa-waze icon-waze'></i>${item["Adresa"]}</a>`:"";
    const tel=item["Telefon"]?`<a class="link-icon" href="tel:${item["Telefon"]}"><i class='fa-solid fa-phone icon-phone'></i>${item["Telefon"]}</a>`:"";

    tr.innerHTML=`
      <td>${item["Zákazník"]||"Neznámý"}</td>
      <td>${addr}</td>
      <td>${tel}</td>
      <td>${item["Stav"]||"Hotovo"}</td>
      <td><button class="action-btn" onclick='openProtocol(${JSON.stringify(item)})'><i class="fa-regular fa-file-lines"></i> Otevřít protokol</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function openProtocol(item){
  item["Stav"]="Hotovo";
  localStorage.setItem("selectedCustomer",JSON.stringify(item));
  window.location.href="protokol.html";
}

document.getElementById("searchInput").addEventListener("input",loadHotove);
window.addEventListener("pageshow",loadHotove);
loadHotove();
</script>
</body>
</html>
