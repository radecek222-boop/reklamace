<!-- 
====================================================================
üü® SEKCE A ‚Äì Z√ÅKLAD STR√ÅNKY S NAVIGAC√ç WGS
====================================================================
-->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seznam reklamac√≠ ‚Äì White Glove Service</title>

<!-- üåç Leaflet mapa -->
<link rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      crossorigin="">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        crossorigin=""></script>

<!-- üìÑ PDF Export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
/* ============================= */
/* üß± Z√ÅKLADN√ç VZHLED STR√ÅNKY     */
/* ============================= */
body {
  font-family: "Inter", system-ui, sans-serif;
  background: #f6f7fb;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

/* ============================= */
/* üì¶ KONTEJNER STR√ÅNKY          */
/* ============================= */
.wrapper {
  background: #fff;
  padding: 25px;
  margin: 80px 15px 40px; /* Rezerva naho≈ôe pro sticky header */
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 1200px;
  box-sizing: border-box;
}

/* ============================= */
/* üß≠ HORN√ç STICKY LI≈†TA (WGS)   */
/* ============================= */
.wgs-header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(180deg, #fdfdfd, #e9e9e9);
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  z-index: 10000;
}
.btn-header-back {
  background: linear-gradient(135deg, #6c757d, #a0a4a7);
  border: none;
  color: #fff;
  font-weight: 500;
  font-size: 0.95em;
  border-radius: 8px;
  padding: 8px 14px;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  transition: transform 0.15s ease, opacity 0.2s ease;
}
.btn-header-back:hover { transform: scale(1.04); opacity: 0.9; }
.wgs-header-title {
  flex: 1;
  text-align: center;
  font-weight: 800;
  font-size: 1.3em;
  color: #111;
  margin: 0;
  letter-spacing: 0.5px;
}
@media (max-width: 700px) {
  .wgs-header { padding: 10px 12px; }
  .btn-header-back { padding: 8px 12px; font-size: 0.9em; }
  .wgs-header-title { font-size: 1.2em; margin-left: -30px; }
}

/* ============================= */
/* üè∑Ô∏è NADPISY                    */
/* ============================= */
h1 {
  text-align: center;
  font-size: 2.2em;
  font-weight: 900;
  color: #111;
  margin: 0 0 8px;
}
h2 {
  text-align: center;
  font-size: 1.1em;
  font-weight: 500;
  color: #666;
  margin: 0 0 25px;
}

/* ============================= */
/* üîò HLAVN√ç TLAƒå√çTKA (akce)     */
/* ============================= */
.actions {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 15px;
  margin-bottom: 25px;
}
.btn {
  display: inline-block;
  text-decoration: none;
  padding: 10px 24px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 1em;
  border: none;
  cursor: pointer;
  transition: transform 0.15s ease-in-out, opacity 0.2s;
  color: white;
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
  min-width: 160px;
}
.btn:hover { transform: scale(1.04); opacity: 0.9; }

/* üé® Barvy tlaƒç√≠tek */
.btn-back    { background: linear-gradient(135deg, #6c757d, #a0a4a7); }
.btn-refresh { background: linear-gradient(135deg, #b80000, #ff3838); }
.btn-green   { background: linear-gradient(135deg, #28a745, #60d06a); text-align:center; }
.btn-plan    { background: linear-gradient(135deg, #0046ff, #357aff); }

/* ============================= */
/* üîç VYHLED√ÅV√ÅN√ç                */
/* ============================= */
#search {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 1em;
  box-sizing: border-box;
}

/* ============================= */
/* üìã TABULKA Z√ÅZNAM≈Æ            */
/* ============================= */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}
th, td {
  padding: 10px 8px;
  border-bottom: 1px solid #eee;
  text-align: center;
  font-size: 0.95em;
  white-space: normal;
  line-height: 1.4em;
  color: #000;
  font-weight: 400;
}
th {
  background: #f8f8f8;
  font-weight: 700;
  color: #000;
}
td.adresa,
td.telefon { font-weight: 600; }
tr:hover { background: #f1f6ff; cursor: pointer; }

/* ============================= */
/* üü¢ STAVY REKLAMAC√ç            */
/* ============================= */
.stav-novy      { background: #fff9b1 !important; }
.stav-domluveno { background: #99b3ff !important; }
.stav-zruseno   { background: #ff6666 !important; }
.stav-nezveda   { background: #ffad33 !important; }

/* ============================= */
/* üì± MOBILN√ç ZOBRAZEN√ç          */
/* ============================= */
@media (max-width:700px){
  table { display:none; }
  .btn {
    width:100%;
    min-width:unset;
    text-align:center;
  }
}
</style>
</head>

<body>
  <!-- üü¶ Horn√≠ li≈°ta WGS -->
  <header class="wgs-header">
    <button class="btn-header-back" onclick="history.back()">‚Üê Zpƒõt</button>
    <h1 class="wgs-header-title">WGS</h1>
  </header>

  <!-- üß± Obsah str√°nky -->
  <div class="wrapper">
    <h1>WHITE GLOVE SERVICE</h1>
    <h2>Seznam reklamac√≠ a servisn√≠ch po≈æadavk≈Ø</h2>

    <!-- üß≠ OVL√ÅDAC√ç TLAƒå√çTKA -->
    <div class="actions">
      <a href="index.html" class="btn btn-back">Zpƒõt</a>
      <button id="reloadBtn" class="btn btn-refresh">Naƒç√≠st znovu</button>
      <a href="hotove.html" class="btn btn-green">Hotov√© reklamace</a>
      <button id="planBtn" class="btn btn-plan">Pl√°n dne</button>
    </div>

    <!-- üîç VYHLED√ÅV√ÅN√ç -->
    <input type="text" id="search"
           placeholder="üîç Hledat podle jm√©na, adresy nebo zadavatele...">

    <!-- üì¶ M√çSTO PRO TABULKU -->
    <div id="tableContainer" class="loading">Naƒç√≠t√°m data...</div>
  </div>
<!-- üü® KONEC SEKCE A -->







  <!-- 
====================================================================
üü¶ SEKCE B ‚Äì NAƒå√çT√ÅN√ç DAT + RENDER TABULKY / BLOK≈Æ
====================================================================
- Naƒç√≠t√° data z Cloudflare Workeru
- Zaji≈°≈•uje vykreslen√≠ tabulky pro PC
- Zaji≈°≈•uje mobiln√≠ bloky pro telefony
- Zahrnuje barevn√© stavy a ikony (Waze / Telefon)
====================================================================
-->

<script>
let dataAll = [];
const tableContainer = document.getElementById("tableContainer");

// üü¢ Naƒçten√≠ dat z Workeru
async function loadData() {
  try {
    console.log("üì• Naƒç√≠t√°m data z Workeru‚Ä¶");
    const res = await fetch("https://wgs-token.72nvwf4pb2.workers.dev/orders");
    const data = await res.json();
    dataAll = Array.isArray(data) ? data : [];
    console.log(`‚úÖ Naƒçteno ${dataAll.length} z√°znam≈Ø`);
    renderTable(dataAll);
  } catch (err) {
    console.error("‚ùå Chyba naƒç√≠t√°n√≠:", err);
    tableContainer.innerHTML =
      `<div style='padding:20px;color:red;text-align:center;'>Chyba naƒç√≠t√°n√≠ dat.</div>`;
  }
}

// üü£ Filtrov√°n√≠
document.getElementById("search").addEventListener("input", e => {
  const term = e.target.value.toLowerCase();
  const filtered = dataAll.filter(r =>
    (r.zakaznik || "").toLowerCase().includes(term) ||
    (r.adresa || "").toLowerCase().includes(term) ||
    (r.contract || "").toLowerCase().includes(term)
  );
  renderTable(filtered);
});

// üîÑ Naƒç√≠st znovu
document.getElementById("reloadBtn").addEventListener("click", loadData);

// üß© Vykreslen√≠ tabulky pro PC
function renderDesktopTable(arr) {
  if (!Array.isArray(arr) || !arr.length) {
    tableContainer.innerHTML = "<div style='padding:20px;text-align:center;color:#555;'>≈Ω√°dn√© z√°znamy.</div>";
    return;
  }

  const ulozene = JSON.parse(localStorage.getItem("stavyReklamaciData") || "[]");
  arr.forEach(z => {
    const ulozeny = ulozene.find(u => u.cislo === z.cislo);
    if (ulozeny) {
      z.datum = ulozeny.datum;
      z.cas = ulozeny.cas;
      if (!z.stav) z.stav = "domluveno";
    }
  });

  const rows = arr.map((r, i) => `
    <tr class="stav-${(r.stav || "novy").toLowerCase()}" onclick="openDetail(${i})">
      <td>${r.contract || "-"}</td>
      <td>${r.cislo || "-"}</td>
      <td>${r.zakaznik || "-"}</td>
      <td class="adresa">${r.adresa || "-"}</td>
      <td>${r.datum || ""} ${r.cas || ""}</td>
      <td>${r.telefon || ""}</td>
    </tr>
  `).join("");

  tableContainer.innerHTML = `
    <table>
      <thead>
        <tr><th>Zak√°zka</th><th>ƒå√≠slo</th><th>Z√°kazn√≠k</th><th>Adresa</th><th>Datum / ƒças</th><th>Telefon</th></tr>
      </thead>
      <tbody>${rows}</tbody>
    </table>
  `;
}

</script>





  <!-- üü© ZAƒå√ÅTEK B-3: MOBILN√ç BLOKY -->
<script>
function renderMobileBlocks(arr) {
  if (!Array.isArray(arr) || !arr.length) {
    tableContainer.innerHTML =
      "<div style='padding:20px;text-align:center;color:#555;'>≈Ω√°dn√© z√°znamy k zobrazen√≠.</div>";
    return;
  }

  const ulozene = JSON.parse(localStorage.getItem("stavyReklamaciData") || "[]");
  arr.forEach(z => {
    const ulozeny = ulozene.find(u => u.cislo === z.cislo);
    if (ulozeny) {
      z.datum = ulozeny.datum;
      z.cas = ulozeny.cas;
      if (!z.stav) z.stav = "domluveno";
    }
  });

  const html = arr.map((r, i) => `
    <div class="mob-block ${r.stav || 'novy'}" onclick="openDetail(${i})">
      <div class="mob-top">
        <div class="mob-name">${r.zakaznik || '-'}</div>
        <div class="mob-icons">
          ${r.adresa ? `<a href="https://waze.com/ul?q=${encodeURIComponent(r.adresa)}" target="_blank" class="mob-btn waze" title="Navigovat">üìç</a>` : ''}
          ${r.telefon ? `<a href="tel:${r.telefon.replace(/\s+/g,'')}" class="mob-btn phone" title="Volat">üìû</a>` : ''}
        </div>
      </div>
      <div class="mob-mid">${r.adresa || '-'}</div>
      <div class="mob-bottom">${r.datum ? r.datum : ''} ${r.cas ? r.cas : ''}</div>
    </div>
  `).join('');

  tableContainer.innerHTML = `<div class="mob-container">${html}</div>`;
}

// üì± Automaticky zvol√≠ tabulku nebo bloky
function renderTable(arr) {
  if (window.innerWidth < 700) renderMobileBlocks(arr);
  else renderDesktopTable(arr);
}
</script>

<style>
/* ============================= */
/* üì± MOBILN√ç BLOKY              */
/* ============================= */
.mob-container {
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 4px;
}
.mob-block {
  border-radius: 10px;
  padding: 8px 12px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.12);
  background: #fff;
  display: flex;
  flex-direction: column;
  gap: 4px;
  transition: transform 0.15s, box-shadow 0.15s;
}
.mob-block:hover {
  transform: scale(1.01);
  box-shadow: 0 3px 8px rgba(0,0,0,0.18);
}
.mob-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.mob-name {
  font-size: 1.05em;
  color: #000;
}
.mob-icons {
  display: flex;
  gap: 6px;
}
.mob-btn {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  text-decoration: none;
  font-size: 1em;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}
.mob-btn.waze {
  background: linear-gradient(135deg, #0046ff, #357aff);
  color: #fff;
}
.mob-btn.phone {
  background: #f5f5f5;
  color: #000;
}
.mob-mid {
  color: #222;
  font-size: 0.9em;
}
.mob-bottom {
  font-size: 0.9em;
  color: #111;
  font-weight: 600;
}

/* üåà BARVY BLOK≈Æ DLE STAVU */
.mob-block.novy      { background: #fff9b1; }
.mob-block.domluveno { background: #99b3ff; }
.mob-block.ceka      { background: #d9b3ff; }
.mob-block.zruseno   { background: #ff6666; color:#fff; }
.mob-block.nezveda   { background: #ffad33; }
.mob-block.hotovo    { background: #b6f2c0; }
</style>
<!-- üü© KONEC B-3 -->



  <!-- 
====================================================================
üü• SEKCE C-1 ‚Äì DETAIL Z√ÅKAZN√çKA (SVƒöTLEJ≈†√ç VERZE)
====================================================================
-->

<script>
function openDetail(index) {
  const item = dataAll[index];
  if (!item) return;

  const overlay = document.createElement("div");
  overlay.className = "detail-overlay";

  overlay.innerHTML = `
    <div class="detail-modal">
      <h2>${item.zakaznik || "Z√°kazn√≠k"}</h2>
      <p><strong>Adresa:</strong> ${item.adresa || "-"}</p>
      <p><strong>Telefon:</strong> ${item.telefon || "-"}</p>
      <p><strong>E-mail:</strong> ${item.email || "-"}</p>
      <p><strong>Popis z√°vady:</strong> ${item.popis || "-"}</p>
      <div id="termInfoBox"></div>

      <div class="detail-buttons">
        <!-- ü©∂ √özk√© ≈°ed√© tlaƒç√≠tko naho≈ôe -->
        <button id="contactBtn" class="btn-action btn-gray">Kontaktovat z√°kazn√≠ka</button>

        <div class="button-columns">
          <div class="left-buttons">
            <button id="saveTermBtn" class="btn-action btn-blue">Ulo≈æit / zmƒõnit term√≠n</button>
            <button id="waitBtn" class="btn-action btn-purple">Z√°kazn√≠k ƒçek√° na d√≠ly</button>
          </div>
          <div class="right-buttons">
            <button id="createProtocolBtn" class="btn-action btn-green">Vytvo≈ôit protokol</button>
            <button id="closeBtn" class="btn-action btn-gray">Zpƒõt</button>
          </div>
        </div>

        <!-- üî¥ Velk√© blikaj√≠c√≠ ƒçerven√© tlaƒç√≠tko -->
        <button id="startVisitBtn" class="btn-action btn-red-blink">Zah√°jit n√°v≈°tƒõvu u z√°kazn√≠ka</button>
      </div>
    </div>
  `;

  document.body.appendChild(overlay);

  // üéØ Ovl√°dac√≠ akce tlaƒç√≠tek
  overlay.querySelector("#contactBtn").onclick = () => openContactModal(item, index, overlay);
  overlay.querySelector("#saveTermBtn").onclick = () => ulozitTermin(item, index, overlay);
  overlay.querySelector("#waitBtn").onclick = () => oznacitCeka(item, index, overlay);
  overlay.querySelector("#createProtocolBtn").onclick = () => {
    localStorage.setItem("protokolData", JSON.stringify(item));
    window.location.href = "protokol.html";
  };
  overlay.querySelector("#closeBtn").onclick = () => overlay.remove();
  overlay.querySelector("#startVisitBtn").onclick = () => {
    localStorage.setItem("photoCustomerData", JSON.stringify(item));
    window.location.href = "photocustomer.html";
  };
}
</script>

<style>
/* ============================================================= */
/* üåø SVƒöTLEJ≈†√ç T√ìN DETAILU Z√ÅKAZN√çKA                            */
/* ============================================================= */
.detail-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.55);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.detail-modal {
  background: #fff;
  border-radius: 12px;
  padding: 25px;
  width: 95%;
  max-width: 520px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 4px 18px rgba(0,0,0,0.25);
}
.detail-modal h2 {
  font-size: 1.4em;
  margin-top: 0;
  color: #000;
}
.detail-modal p {
  font-size: 0.95em;
  color: #111;
  margin: 4px 0;
}

/* üß© Rozlo≈æen√≠ tlaƒç√≠tek */
.detail-buttons {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  margin-top: 20px;
}
.button-columns {
  display: flex;
  justify-content: center;
  gap: 12px;
  width: 100%;
}
.left-buttons, .right-buttons {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* üîò Styl tlaƒç√≠tek */
.btn-action {
  border: none;
  border-radius: 8px;
  padding: 12px 20px;
  font-size: 1em;
  color: #fff;
  cursor: pointer;
  transition: transform 0.15s ease, opacity 0.2s ease;
  width: 100%;
  font-weight: 400;
}
.btn-action:hover { transform: scale(1.03); opacity: 0.9; }

/* üåà Barvy ‚Äì svƒõtlej≈°√≠ odst√≠ny */
.btn-gray   { background: linear-gradient(135deg, #b8b8b8, #d4d4d4); }
.btn-blue   { background: linear-gradient(135deg, #87a9ff, #bcd3ff); }
.btn-green  { background: linear-gradient(135deg, #93e5b4, #b9f0d0); }
.btn-purple { background: linear-gradient(135deg, #cdb9ff, #e1d4ff); }

/* üî¥ Blikaj√≠c√≠ tlaƒç√≠tko ‚Äì mƒõkƒç√≠ ƒçerven√° */
.btn-red-blink {
  background: linear-gradient(135deg, #ff6b6b, #ff8c8c);
  animation: blinkSoft 1.5s infinite;
  height: calc(2 * 46px);
  font-size: 1.05em;
  letter-spacing: 0.2px;
  border-radius: 10px;
}
@keyframes blinkSoft {
  0%, 100% { opacity: 1; background: linear-gradient(135deg, #ff6b6b, #ff8c8c); }
  50% { opacity: 0.75; background: linear-gradient(135deg, #ff9a9a, #ffb3b3); }
}

/* ü©∂ Kontaktovat z√°kazn√≠ka */
.btn-gray {
  background: linear-gradient(135deg, #c0c0c0, #e4e4e4);
  color: #fff;
}

/* üì± Mobiln√≠ √∫pravy */
@media (max-width:700px){
  .detail-modal { padding: 15px; }
}
</style>






  <!-- 
====================================================================
üü¶ SEKCE C-2 ‚Äì MAPA A VZD√ÅLENOST (ZJEDNODU≈†EN√Å A SVƒöTLEJ≈†√ç)
====================================================================
-->

<script>
function initMapForDetail(overlay, item) {
  if (!item.adresa) return;
  const wgs = [50.049, 14.523];
  const map = L.map(overlay.querySelector("#mapDetail")).setView(wgs, 9);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "¬© OpenStreetMap"
  }).addTo(map);

  const wgsMarker = L.marker(wgs, { title: "WGS" }).addTo(map);

  fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(item.adresa)}`)
    .then(r => r.json())
    .then(d => {
      if (d[0]) {
        const c = [+d[0].lat, +d[0].lon];
        const cust = L.marker(c, { title: item.zakaznik || "Z√°kazn√≠k" }).addTo(map);
        L.polyline([wgs, c], { color: "#4a7aff", weight: 3 }).addTo(map);

        const dist = calcDistanceCoords(wgs[0], wgs[1], c[0], c[1]);
        overlay.querySelector("#mapDistance").textContent =
          `Vzd√°lenost od WGS: ${dist.toFixed(1)} km`;

        map.fitBounds(L.featureGroup([wgsMarker, cust]).getBounds().pad(0.3));
      }
    });
}
</script>

<style>
#mapDetail {
  height: 280px;
  border-radius: 10px;
  border: 1px solid #ccc;
  margin-top: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}
.distance-banner {
  background: #f9fafc;
  border-radius: 8px;
  padding: 8px 10px;
  text-align: center;
  font-weight: 600;
  color: #333;
  margin-top: 10px;
  font-family: "Inter", sans-serif;
}
@media (max-width:700px){ #mapDetail{height:240px;} }
</style>
<!-- üü¶ KONEC SEKCE C-2 -->





  <!-- 
====================================================================
üü® SEKCE C-3 ‚Äì KALEND√Å≈ò A ƒåAS (VANILLA CALENDAR + LIGHT UI)
====================================================================
-->

<script>
function initCalendarAndTime(overlay, item, index) {
  const infoBox = overlay.querySelector("#termInfoBox");

  const miniCal = new VanillaCalendar("#miniCalendar", {
    settings: {
      lang: "cs",
      selection: { day: "single" },
      visibility: { theme: "light" }
    },
    actions: {
      clickDay: e => {
        const chosen = e.target.dataset.calendarDay;
        if (chosen) {
          overlay.dataset.datum = chosen;
          updateTermInfoBox(infoBox, chosen, null);
          flashBox(infoBox, "gray");
        }
      }
    }
  });
  miniCal.init();

  // naplnƒõn√≠ hodin a minut
  const hSel = overlay.querySelector("#hours"),
        mSel = overlay.querySelector("#minutes");
  for (let h = 7; h < 20; h++)
    hSel.innerHTML += `<option>${String(h).padStart(2,"0")}</option>`;
  for (let m = 0; m < 60; m += 5)
    mSel.innerHTML += `<option>${String(m).padStart(2,"0")}</option>`;

  hSel.addEventListener("change", () => updateTime(infoBox, overlay));
  mSel.addEventListener("change", () => updateTime(infoBox, overlay));
}
</script>

<style>
#miniCalendar {
  margin-bottom: 12px;
  border: 1px solid #ddd;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0,0,0,0.08);
}

.custom-time-picker {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin-bottom: 10px;
}
.custom-time-picker select {
  font-size: 1.05em;
  font-weight: 500;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 5px 10px;
  background: #fff;
  color: #000;
}
.custom-time-picker span {
  font-size: 1.2em;
  color: #444;
  font-weight: 600;
}

/* üü¢ box s informac√≠ o zvolen√©m term√≠nu */
.term-info-box {
  background: #f4f6f9;
  border-radius: 8px;
  padding: 10px;
  text-align: center;
  font-weight: 600;
  color: #111;
  margin-bottom: 12px;
  transition: background .3s;
}
.flash-gray { animation: flashGray .4s; }
.flash-green { animation: flashGreen .5s 2; }

@keyframes flashGray { 0%{background:#e0e0e0;}100%{background:#f4f6f9;} }
@keyframes flashGreen { 0%,100%{background:#c9f5c2;}50%{background:#e5ffe2;} }
</style>
<!-- üü® KONEC SEKCE C-3 -->



<!-- 
====================================================================
üü© SEKCE C-4 ‚Äì KONTAKTOVAT Z√ÅKAZN√çKA
====================================================================
-->

<script>
function openContactModal(item, index, parentOverlay) {
  const modal = document.createElement("div");
  modal.className = "contact-modal-overlay";
  modal.innerHTML = `
    <div class="contact-modal">
      <h3>Kontaktovat z√°kazn√≠ka</h3>
      <p><strong>${item.zakaznik || "Z√°kazn√≠k"}</strong><br>
         ${item.adresa || ""}</p>

      <div class="contact-buttons">
        <a href="tel:${item.telefon ? item.telefon.replace(/\s+/g,'') : ''}"
           class="btn-contact btn-green">Volat z√°kazn√≠kovi</a>
        <button class="btn-contact btn-blue" id="smsBtn">Nezved√° ‚Äì posl√°na SMS</button>
        <button class="btn-contact btn-gray" id="cancelBtn">Zru≈°eno z√°kazn√≠kem</button>
      </div>

      <button class="btn-close-contact">Zav≈ô√≠t</button>
    </div>
  `;
  document.body.appendChild(modal);
  setTimeout(() => modal.classList.add("active"), 20);

  const smsBtn = modal.querySelector("#smsBtn");
  const cancelBtn = modal.querySelector("#cancelBtn");
  const closeBtn = modal.querySelector(".btn-close-contact");

  smsBtn.onclick = async () => {
    try {
      item.stav = "nezveda";
      stavy[item.cislo] = "nezveda";
      await fetch("https://wgs-token.72nvwf4pb2.workers.dev/orders", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ record: item })
      });
      showToast("üì© SMS odesl√°na", "success");
      modal.remove();
      parentOverlay.remove();
      renderTable(dataAll);
    } catch (err) {
      alert("‚ùå Chyba p≈ôi odes√≠l√°n√≠ SMS: " + err.message);
    }
  };

  cancelBtn.onclick = async () => {
    try {
      item.stav = "zruseno";
      stavy[item.cislo] = "zruseno";
      await fetch("https://wgs-token.72nvwf4pb2.workers.dev/orders", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ record: item })
      });
      showToast("‚ùå Z√°kazn√≠k zru≈°il term√≠n", "warning");
      modal.remove();
      parentOverlay.remove();
      renderTable(dataAll);
    } catch (err) {
      alert("‚ùå Chyba p≈ôi ukl√°d√°n√≠: " + err.message);
    }
  };

  closeBtn.onclick = () => modal.remove();
}
</script>

<style>
/* ============================================================= */
/* üé® VZHLED KONTAKTN√çHO OKNA (SVƒöTLEJ≈†√ç VERZE)                 */
/* ============================================================= */
.contact-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  opacity: 0;
  transition: opacity .25s ease;
}
.contact-modal-overlay.active { opacity: 1; }

.contact-modal {
  background: #fff;
  border-radius: 14px;
  padding: 24px 26px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  width: 90%;
  max-width: 420px;
  text-align: center;
  font-family: "Inter", sans-serif;
}
.contact-modal h3 {
  margin: 0 0 10px;
  font-size: 1.3em;
  color: #000;
}
.contact-modal p {
  margin: 0 0 20px;
  color: #222;
  font-size: .95em;
}

/* üîò Tlaƒç√≠tka v modalu */
.contact-buttons {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 18px;
}
.btn-contact {
  display: inline-block;
  border: none;
  border-radius: 8px;
  padding: 12px;
  font-size: 1em;
  font-weight: 400;
  color: #fff;
  cursor: pointer;
  text-decoration: none;
  transition: opacity .2s ease, transform .2s ease;
}
.btn-contact:hover { opacity: .9; transform: scale(1.03); }

/* üåà Barvy ‚Äì svƒõtlej≈°√≠ */
.btn-green { background: linear-gradient(135deg,#93e5b4,#b9f0d0); }
.btn-blue  { background: linear-gradient(135deg,#9ac1ff,#c2d9ff); }
.btn-gray  { background: linear-gradient(135deg,#d3d3d3,#e8e8e8); }

/* üîò Zav√≠rac√≠ tlaƒç√≠tko */
.btn-close-contact {
  background: linear-gradient(135deg,#b8b8b8,#d8d8d8);
  color: #000;
  border: none;
  border-radius: 8px;
  padding: 10px 18px;
  font-size: .95em;
  cursor: pointer;
  transition: opacity .2s ease;
}
.btn-close-contact:hover { opacity: .85; }

/* üì± Mobil */
@media (max-width:700px){
  .contact-modal{padding:18px 20px;}
  .btn-contact{font-size:.95em;}
}
</style>




  

  <!-- 
====================================================================
üü© SEKCE C-5 ‚Äì POMOCN√â FUNKCE (TERM√çN + FLASH + VZD√ÅLENOST)
====================================================================
-->

<script>
/* üóìÔ∏è Aktualizace textu v termInfoBoxu p≈ôi zmƒõnƒõ data nebo ƒçasu */
function updateTermInfoBox(box, datum, cas) {
  if (!box) return;
  const d = new Date(datum);
  if (isNaN(d)) { box.textContent = "Vyberte platn√© datum"; return; }

  const den = d.toLocaleDateString("cs-CZ", {
    weekday: "long", day: "numeric", month: "long"
  });
  box.textContent = cas ? `${den} ‚Äì ${cas}` : `${den}`;
}

/* üïí P≈ôi zmƒõnƒõ selectu hodin a minut ‚Äì aktualizace + efekt bliknut√≠ */
function updateTime(box, overlay) {
  const datum = overlay.dataset.datum;
  if (!datum) return;
  const h = overlay.querySelector("#hours").value;
  const m = overlay.querySelector("#minutes").value;
  const cas = `${h}:${m}`;
  updateTermInfoBox(box, datum, cas);
  flashBox(box, "green");
}

/* ‚ú® Kr√°tk√© bliknut√≠ informaƒçn√≠ho boxu po ulo≈æen√≠ nebo zmƒõnƒõ */
function flashBox(el, color = "gray") {
  if (!el) return;
  el.classList.remove("flash-gray", "flash-green");
  void el.offsetWidth; // reset animace
  el.classList.add(color === "green" ? "flash-green" : "flash-gray");
}

/* üìè V√Ωpoƒçet vzd√°lenosti mezi dvƒõma sou≈ôadnicemi (v km) */
function calcDistanceCoords(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLon = (lon2 - lon1) * Math.PI / 180;
  const a = Math.sin(dLat / 2) ** 2 +
             Math.cos(lat1 * Math.PI / 180) *
             Math.cos(lat2 * Math.PI / 180) *
             Math.sin(dLon / 2) ** 2;
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}
</script>

<style>
/* ‚ú® Animace bliknut√≠ ≈°ed√° / zelen√° */
.flash-gray  { animation: flashGray .4s ease; }
.flash-green { animation: flashGreen .5s ease 2; }

@keyframes flashGray {
  0% { background:#e0e0e0; } 
  100% { background:#f4f6f9; }
}
@keyframes flashGreen {
  0%,100% { background:#c9f5c2; } 
  50% { background:#e5ffe2; }
}
</style>
<!-- üü© KONEC SEKCE C-5 -->



  <!-- 
====================================================================
üüß SEKCE D ‚Äì ULO≈ΩEN√ç TERM√çNU NA GITHUB + TOAST + OVERLAY
====================================================================
-->

<script>
async function ulozitTerminNaGitHub(item, id, datum, cas, overlay, btn, infoBox) {
  try {
    stavy[id] = "domluveno";
    item.datum = datum;
    item.cas = cas;
    item.stav = "domluveno";

    const loader = document.createElement("div");
    loader.className = "loader-overlay";
    loader.innerHTML = `
      <div class="loader-inner">
        <div class="spinner"></div>
        <div>Ukl√°d√°m term√≠n‚Ä¶</div>
      </div>`;
    document.body.appendChild(loader);

    const res = await fetch("https://wgs-token.72nvwf4pb2.workers.dev/orders", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ action: "update", record: item })
    });
    if (!res.ok) throw new Error("HTTP " + res.status);

    // √∫spƒõch
    loader.remove();
    showSuccessOverlay("‚úÖ Term√≠n ulo≈æen", "Z√°znam byl ulo≈æen do GitHub repozit√°≈ôe.");
    ulozTermin(item);
    localStorage.setItem("stavyReklamaci", JSON.stringify(stavy));
    flashBox(infoBox, "green");
    setNextToast("‚úÖ Term√≠n √∫spƒõ≈°nƒõ ulo≈æen", "success");

    setTimeout(() => {
      overlay.remove();
      renderTable(dataAll);
    }, 1500);
  } catch (err) {
    document.querySelector(".loader-overlay")?.remove();
    alert("‚ùå Chyba p≈ôi ukl√°d√°n√≠ term√≠nu: " + err.message);
    showToast("Chyba p≈ôi ukl√°d√°n√≠!", "error");
  }
}

/* üßæ Kr√°tk√° toast zpr√°va v rohu */
function showToast(msg, type = "success") {
  const toast = document.createElement("div");
  toast.className = `wgs-toast ${type}`;
  toast.innerHTML = `<span>${msg}</span>`;
  document.body.appendChild(toast);
  setTimeout(() => toast.classList.add("active"), 50);
  setTimeout(() => {
    toast.classList.remove("active");
    setTimeout(() => toast.remove(), 400);
  }, 3500);
}

function setNextToast(msg, type = "success") {
  sessionStorage.setItem("wgsToastMsg", msg);
  sessionStorage.setItem("wgsToastType", type);
}

window.addEventListener("DOMContentLoaded", () => {
  const toastMsg = sessionStorage.getItem("wgsToastMsg");
  const toastType = sessionStorage.getItem("wgsToastType");
  if (toastMsg) {
    showToast(toastMsg, toastType);
    sessionStorage.removeItem("wgsToastMsg");
    sessionStorage.removeItem("wgsToastType");
  }
});

/* üéâ B√≠l√Ω overlay u prost≈ôed obrazovky */
function showSuccessOverlay(title, text) {
  const ok = document.createElement("div");
  ok.className = "successOverlay";
  ok.innerHTML = `
    <div class="successInner">
      <div class="icon">‚úÖ</div>
      <div class="title">${title}</div>
      <div class="text">${text}</div>
    </div>`;
  document.body.appendChild(ok);
  setTimeout(() => ok.classList.add("active"), 50);
  setTimeout(() => {
    ok.classList.remove("active");
    setTimeout(() => ok.remove(), 400);
  }, 2000);
}
</script>

<style>
/* ============================================================= */
/* üé® LOADER, TOAST A POTVRZEN√ç                                 */
/* ============================================================= */

/* ‚è≥ Loader bƒõhem ukl√°d√°n√≠ */
.loader-overlay {
  position: fixed; inset: 0;
  background: rgba(255,255,255,0.88);
  display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  font-family: "Inter", sans-serif;
  color: #0046ff; font-weight: 600;
  font-size: 1.1em; z-index: 99999;
}
.spinner {
  width: 42px; height: 42px;
  border: 4px solid #6fa8ff;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 1.1s linear infinite;
  margin-bottom: 10px;
}
@keyframes spin { from {transform:rotate(0)} to {transform:rotate(360deg)} }

/* ‚úÖ Success overlay */
.successOverlay {
  position: fixed; inset: 0;
  background: rgba(255,255,255,0.9);
  display: flex; justify-content: center; align-items: center;
  opacity: 0; transition: opacity .3s ease; z-index: 100000;
}
.successOverlay.active { opacity: 1; }
.successInner {
  background: #fff;
  border-left: 6px solid #4caf50;
  border-radius: 12px;
  padding: 25px 30px;
  text-align: center;
  font-family: "Inter", sans-serif;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  max-width: 340px;
}
.successInner .icon  { font-size: 2em; margin-bottom: 10px; }
.successInner .title { font-size: 1.25em; font-weight: 700; color: #4caf50; margin-bottom: 6px; }
.successInner .text  { font-size: .95em; color: #333; }

/* üîî Toast vpravo naho≈ôe */
.wgs-toast {
  position: fixed; top: 20px; right: 20px;
  background: #fff;
  padding: 14px 22px;
  border-radius: 8px;
  box-shadow: 0 3px 12px rgba(0,0,0,0.15);
  font-family: "Inter", sans-serif;
  font-size: .95em; font-weight: 600;
  color: #111;
  opacity: 0; transform: translateY(-10px);
  transition: all .35s ease; z-index: 100001;
}
.wgs-toast.active { opacity: 1; transform: translateY(0); }
.wgs-toast.success { border-left: 5px solid #4caf50; }
.wgs-toast.error   { border-left: 5px solid #dc3545; }
.wgs-toast.warning { border-left: 5px solid #ff9800; }
</style>
<!-- üüß KONEC SEKCE D -->





  <!-- 
====================================================================
üü¶ SEKCE E-1 ‚Äì MOD√ÅLN√ç OKNO ‚ÄûPL√ÅN DNE‚Äú
====================================================================
-->

<div id="planModal" class="plan-modal">
  <div class="plan-content">
    <div class="plan-header">
      <h2>üìÖ Pl√°n dne</h2>
      <button class="btn-close" onclick="closePlanModal()">‚úï</button>
    </div>
    <div id="planLegend"></div>
    <div id="planMap"></div>
    <div id="planList"></div>
  </div>
</div>

<style>
.plan-modal {
  display:none; position:fixed; inset:0;
  background:rgba(255,255,255,0.95);
  justify-content:center; align-items:center;
  z-index:10000;
}
.plan-modal.active { display:flex; animation:fadeIn .25s ease; }

.plan-content {
  background:#fff;
  width:96%; max-width:1000px;
  max-height:94%;
  overflow:auto;
  border-radius:16px;
  box-shadow:0 4px 18px rgba(0,0,0,0.25);
  padding:20px;
  position:relative;
  font-family:"Inter",sans-serif;
}
.plan-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
.plan-header h2 { margin:0; font-size:1.6em; color:#111; }
.btn-close {
  background:none; border:none; font-size:1.4em; cursor:pointer; color:#444;
}
@keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

#planMap {
  width:100%; height:320px;
  border-radius:12px;
  margin-bottom:16px;
  box-shadow:0 2px 6px rgba(0,0,0,0.12);
}
</style>

<script>
function openPlanModal(date){
  const modal=document.getElementById("planModal");
  modal.classList.add("active");
  loadPlanForDay(date,modal);
}
function closePlanModal(){
  document.getElementById("planModal").classList.remove("active");
}
</script>
<!-- üü¶ KONEC SEKCE E-1 -->






  <!-- 
====================================================================
üü® SEKCE E-2 ‚Äì NAƒåTEN√ç A ZOBRAZEN√ç PL√ÅNU
====================================================================
-->

<script>
async function loadPlanForDay(date, overlay){
  const list=dataAll.filter(r=>r.datum===date && r.stav!=="zruseno");
  const legend=overlay.querySelector("#planLegend");
  const mapDiv=overlay.querySelector("#planMap");
  const listDiv=overlay.querySelector("#planList");

  legend.innerHTML=""; listDiv.innerHTML="";
  if(!list.length){
    listDiv.innerHTML="<div style='text-align:center;padding:20px;'>≈Ω√°dn√© zak√°zky pro tento den.</div>";
    return;
  }

  // Se≈ôad√≠me dle ƒçasu
  list.sort((a,b)=>(a.cas||"").localeCompare(b.cas||""));

  legend.innerHTML=`<div class="legend-title">üïí ${date}</div>
  <table class="legend-table">
    <tr><th>#</th><th>Z√°kazn√≠k</th><th>ƒåas</th><th>Vzd√°lenost</th></tr>
  </table>`;

  const table=legend.querySelector(".legend-table");

  const map=L.map(mapDiv,{center:[49.8,15.4],zoom:7,attributionControl:false});
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(map);

  const wgs=[50.049,14.523];
  const markers=[L.marker(wgs,{title:"WGS"})];
  const coords=[wgs];

  for(let i=0;i<list.length;i++){
    const item=list[i];
    const addr=item.adresa||"";
    const c=await geocodeAddress(addr);
    if(!c) continue;
    coords.push([c.lat,c.lon]);
    const marker=L.marker([c.lat,c.lon],{title:item.zakaznik}).addTo(map);
    markers.push(marker);
    const row=document.createElement("tr");
    row.innerHTML=`<td>${i+1}</td><td>${item.zakaznik}</td><td>${item.cas||"‚Äì"}</td><td class="distance-cell">‚Ä¶</td>`;
    table.appendChild(row);

    const card=document.createElement("div");
    card.className="plan-card";
    card.innerHTML=`<b>${i+1}. ${item.zakaznik}</b><br>
    <span>${addr}</span><br>
    <span class="time">${item.cas||"‚Äì"}</span>`;
    listDiv.appendChild(card);
  }

  // Vykresl√≠me trasu
  const line=L.polyline(coords,{color:"#2b6eff",weight:3}).addTo(map);
  map.fitBounds(line.getBounds().pad(0.3));
}
</script>

<style>
.legend-title {
  font-weight:700;
  font-size:1.1em;
  margin-bottom:6px;
  color:#333;
}
.legend-table {
  width:100%; border-collapse:collapse;
  font-size:0.9em;
  background:#fafafa;
  border-radius:8px;
  overflow:hidden;
}
.legend-table th, .legend-table td {
  border:1px solid #ddd;
  padding:6px 8px;
  text-align:center;
}
.legend-table th { background:#f0f3f7; color:#222; }

.plan-card {
  background:linear-gradient(180deg,#fdfdfd,#f1f1f1);
  border:1px solid #ddd;
  border-radius:10px;
  padding:10px 12px;
  margin-bottom:8px;
  box-shadow:0 2px 4px rgba(0,0,0,0.05);
}
.plan-card b { font-size:1.05em; color:#000; }
.plan-card .time { font-weight:600; color:#0046ff; }
@media(max-width:700px){
  .legend-table { font-size:0.8em; }
}
</style>
<!-- üü® KONEC SEKCE E-2 -->






  <!-- 
====================================================================
üü© SEKCE E-3 ‚Äì GEOK√ìDOV√ÅN√ç ADRES
====================================================================
-->
<script>
async function geocodeAddress(address){
  try{
    const url=`https://api.geoapify.com/v1/geocode/search?text=${encodeURIComponent(address)}&lang=cs&apiKey=b363199bb14e47189558d03b81ca9ba1`;
    const res=await fetch(url);
    const data=await res.json();
    if(data.features?.length){
      const p=data.features[0].properties;
      return {lat:p.lat,lon:p.lon};
    }
  }catch(e){console.warn("‚ö†Ô∏è geocode error",address,e);}
  return null;
}
</script>
<!-- üü© KONEC SEKCE E-3 -->






  <!-- 
====================================================================
üüß SEKCE E-4 ‚Äì STYLY PRO PL√ÅN DNE
====================================================================
-->
<style>
#planList {
  margin-top:14px;
}
#planList .plan-card {
  transition:transform .15s ease;
}
#planList .plan-card:hover {
  transform:scale(1.02);
}
</style>
<!-- üüß KONEC SEKCE E-4 -->





  <!-- 
====================================================================
üü• SEKCE F ‚Äì OVL√ÅDAC√ç TLAƒå√çTKA V DETAILU Z√ÅKAZN√çKA
====================================================================
-->

<div class="detail-buttons">
  <button class="btn-gray" id="btnContactCustomer">Kontaktovat z√°kazn√≠ka</button>

  <div class="button-grid">
    <button class="btn-blue" id="btnSaveTerm">Ulo≈æit / Zmƒõnit term√≠n</button>
    <button class="btn-green" id="btnProtocol">Vytvo≈ôit protokol</button>
    <button class="btn-yellow" id="btnWaiting">Z√°kazn√≠k ƒçek√° na d√≠ly</button>
    <button class="btn-dark" id="btnBack">Zpƒõt</button>
  </div>

  <button class="btn-red-flash" id="btnStartVisit">Zah√°jit n√°v≈°tƒõvu u z√°kazn√≠ka</button>
</div>

<style>
.detail-buttons {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  font-family: "Inter", sans-serif;
}
.button-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  width: 100%;
  max-width: 520px;
}

/* jednotn√Ω z√°klad tlaƒç√≠tek */
.detail-buttons button {
  width: 100%;
  border: none;
  border-radius: 10px;
  padding: 12px 0;
  color: #fff;
  font-weight: 400;
  font-size: 1em;
  cursor: pointer;
  transition: all .2s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}
.btn-gray { background: linear-gradient(180deg,#d3d3d3,#b5b5b5); color:#fff; width: 100%; max-width: 520px; }
.btn-blue { background: linear-gradient(180deg,#5fa8ff,#357aff); }
.btn-green { background: linear-gradient(180deg,#87d18c,#5abf66); }
.btn-yellow { background: linear-gradient(180deg,#ffd97a,#ffb200); color:#222; }
.btn-dark { background: linear-gradient(180deg,#9b9b9b,#7a7a7a); }

.btn-gray:hover,
.btn-blue:hover,
.btn-green:hover,
.btn-yellow:hover,
.btn-dark:hover {
  transform: scale(1.04);
  opacity: 0.9;
}

/* üî¥ blikaj√≠c√≠ velk√© tlaƒç√≠tko ZAH√ÅJIT N√ÅV≈†TƒöVU */
.btn-red-flash {
  background: linear-gradient(180deg,#ff5757,#e00000);
  animation: flashRed 1.5s infinite ease-in-out;
  width: 100%;
  max-width: 520px;
  height: 70px;
  font-size: 1.05em;
  color:#fff;
  font-weight: 400;
}
@keyframes flashRed {
  0%, 100% { opacity: 1; box-shadow: 0 0 12px rgba(255,0,0,0.5); }
  50% { opacity: 0.8; box-shadow: 0 0 20px rgba(255,0,0,0.8); }
}

/* Na mobilech vƒõt≈°√≠ mezery pro dotyk */
@media(max-width: 700px){
  .detail-buttons { gap: 10px; }
  .button-grid { gap: 8px; }
  .detail-buttons button { font-size: 1em; padding: 14px 0; }
}
</style>

<script>
document.getElementById("btnContactCustomer")?.addEventListener("click",()=>{
  openContactModal();
});

document.getElementById("btnSaveTerm")?.addEventListener("click",()=>{
  openSaveTermModal();
});

document.getElementById("btnProtocol")?.addEventListener("click",()=>{
  window.location.href = "protokol.html";
});

document.getElementById("btnBack")?.addEventListener("click",()=>{
  document.querySelector(".detail-overlay")?.remove();
});

document.getElementById("btnStartVisit")?.addEventListener("click",()=>{
  window.location.href = "photocustomer.html";
});
</script>
<!-- üü• KONEC SEKCE F -->




  <!-- 
====================================================================
üü© SEKCE G ‚Äì KONTAKTOV√ÅN√ç Z√ÅKAZN√çKA (Volat / SMS / E-mail / Zpƒõt)
====================================================================
-->

<div id="contactModal" class="contact-modal">
  <div class="contact-content">
    <h2>Kontaktovat z√°kazn√≠ka</h2>
    <p id="contactName">‚Äì</p>

    <div class="contact-buttons">
      <a id="callBtn" class="btn-call" target="_blank">üìû Zavolat</a>
      <a id="smsBtn" class="btn-sms" target="_blank">üí¨ Poslat SMS</a>
      <a id="mailBtn" class="btn-mail" target="_blank">‚úâÔ∏è Poslat e-mail</a>
      <button class="btn-back" onclick="closeContactModal()">Zpƒõt</button>
    </div>
  </div>
</div>

<style>
.contact-modal {
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,0.55);
  justify-content:center; align-items:center;
  z-index:10001; opacity:0;
  transition:opacity .25s ease;
}
.contact-modal.active { display:flex; opacity:1; }

.contact-content {
  background:#fff;
  border-radius:14px;
  padding:22px 24px;
  width:92%; max-width:380px;
  text-align:center;
  box-shadow:0 4px 16px rgba(0,0,0,0.25);
  font-family:"Inter",sans-serif;
}
.contact-content h2 {
  margin:0 0 8px;
  font-size:1.4em; color:#111;
}
.contact-content p {
  margin:0 0 16px; font-weight:600; color:#444;
}
.contact-buttons {
  display:flex;
  flex-direction:column;
  gap:10px;
}
.contact-buttons a,
.contact-buttons button {
  display:block;
  text-decoration:none;
  border:none;
  border-radius:10px;
  padding:12px 0;
  font-size:1em;
  font-weight:500;
  color:#fff;
  transition:transform .15s ease, opacity .2s;
  box-shadow:0 2px 6px rgba(0,0,0,0.15);
}
.contact-buttons a:hover,
.contact-buttons button:hover {
  transform:scale(1.04);
  opacity:0.9;
}

.btn-call  { background:linear-gradient(180deg,#4caf50,#6edb6e); }
.btn-sms   { background:linear-gradient(180deg,#2196f3,#4faefc); }
.btn-mail  { background:linear-gradient(180deg,#ffb200,#ffd35e); color:#222; }
.btn-back  { background:linear-gradient(180deg,#b5b5b5,#9a9a9a); color:#fff; }
</style>

<script>
function openContactModal(item){
  const modal=document.getElementById("contactModal");
  const name=document.getElementById("contactName");
  const call=document.getElementById("callBtn");
  const sms=document.getElementById("smsBtn");
  const mail=document.getElementById("mailBtn");

  name.textContent=item?.zakaznik || "Z√°kazn√≠k";
  const tel=item?.telefon?.replace(/\s+/g,"") || "";
  const email=item?.email || "";

  if(tel){
    call.href=`tel:${tel}`;
    sms.href=`sms:${tel}`;
  }else{
    call.href="#"; call.style.opacity="0.5"; sms.href="#"; sms.style.opacity="0.5";
  }
  if(email){
    mail.href=`mailto:${email}?subject=Reklamace%20‚Äì%20White%20Glove%20Service`;
  }else{
    mail.href="#"; mail.style.opacity="0.5";
  }

  modal.classList.add("active");
}
function closeContactModal(){
  document.getElementById("contactModal").classList.remove("active");
}
</script>
<!-- üü© KONEC SEKCE G -->





  <!-- 
====================================================================
üü¶ SEKCE H ‚Äì HORN√ç NAVIGAƒåN√ç LI≈†TA (Zpƒõt + WGS)
====================================================================
-->

<header class="wgs-header">
  <button class="btn-header-back" onclick="history.back()">‚Üê Zpƒõt</button>
  <h1 class="wgs-header-title">WGS</h1>
</header>

<style>
/* üîπ Horn√≠ li≈°ta */
.wgs-header {
  position: sticky;
  top: 0;
  width: 100%;
  background: linear-gradient(180deg,#fdfdfd,#e9e9e9);
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  z-index: 10000;
  font-family: "Inter", sans-serif;
}

/* üîπ Tlaƒç√≠tko ‚ÄûZpƒõt‚Äú vlevo */
.btn-header-back {
  background: linear-gradient(135deg,#6c757d,#a0a4a7);
  border: none;
  color: #fff;
  font-weight: 500;
  font-size: 0.95em;
  border-radius: 8px;
  padding: 8px 14px;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  transition: transform 0.15s ease, opacity 0.2s ease;
}
.btn-header-back:hover { transform: scale(1.04); opacity: 0.9; }

/* üîπ N√°pis WGS */
.wgs-header-title {
  flex: 1;
  text-align: center;
  font-weight: 800;
  font-size: 1.3em;
  color: #111;
  margin: 0;
  letter-spacing: 0.5px;
}

/* üîπ Mobiln√≠ p≈ôizp≈Øsoben√≠ */
@media (max-width: 700px) {
  .wgs-header {
    justify-content: space-between;
    padding: 10px 12px;
  }
  .wgs-header-title {
    font-size: 1.2em;
    text-align: center;
    margin-left: -30px; /* opticky vycentruje mezi tlaƒç√≠tkem a prav√Ωm okrajem */
  }
  .btn-header-back {
    padding: 8px 12px;
    font-size: 0.9em;
  }
}
</style>
<!-- üü¶ KONEC SEKCE H -->

