<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>WHITE GLOVE SERVICE – Seznam reklamací</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin:20px; background:#f6f7fb; }
    h1 { text-align:center; font-size:22px; margin-bottom:20px; }
    table { width:100%; border-collapse:collapse; background:white; box-shadow:0 0 8px rgba(0,0,0,0.1); }
    th, td { padding:8px; border:1px solid #ddd; text-align:left; font-size:14px; }
    th { background:#333; color:white; }
    tr:nth-child(even){ background:#f9f9f9; }
    tr:hover { background:#f1f1f1; }
    .btn { padding:4px 8px; background:#333; color:white; border:none; cursor:pointer; border-radius:4px; }
    .btn:hover { background:#555; }
    @media(max-width:768px){
      table, thead, tbody, th, td, tr { display:block; }
      th { position:sticky; top:0; background:#333; color:#fff; }
      td { border:none; border-bottom:1px solid #eee; }
    }
  </style>
</head>
<body>
  <h1>Seznam reklamací</h1>
  <table id="claimsTable">
    <thead>
      <tr>
        <th>Číslo objednávky</th>
        <th>Číslo reklamace</th>
        <th>Zákazník</th>
        <th>Adresa</th>
        <th>Telefon</th>
        <th>Email</th>
        <th>Stav / termín</th>
        <th>Otevřít</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetURL = "PASTE-YOUR-APPSCRIPT-URL-HERE"; // zde máš svůj Apps Script JSON feed

    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector("#claimsTable tbody");
        tbody.innerHTML = "";
        data.forEach(row => {
          const tr = document.createElement("tr");

          tr.innerHTML = `
            <td>${row["Order number"] || ""}</td>
            <td>${row["Label"] || ""}</td>
            <td>${row["Customer"] || ""}</td>
            <td><a href="https://waze.com/ul?q=${encodeURIComponent(row["Address"]||"")}" target="_blank">${row["Address"] || ""}</a></td>
            <td><a href="tel:${row["KONTAKT"]||""}">${row["KONTAKT"] || ""}</a></td>
            <td><a href="mailto:${row["Email"]||""}">${row["Email"] || ""}</a></td>
            <td>${row["STAV - termín návštěvy"] || ""}</td>
            <td><button class="btn" onclick='openProtocol(${JSON.stringify(row)})'>Otevřít protokol</button></td>
          `;
          tbody.appendChild(tr);
        });
      });

    function openProtocol(row){
      // otevře protokol a předá data
      const win = window.open("protokol.html","_blank");
      setTimeout(() => {
        win.postMessage({ type:"openProtocol", row }, "*");
      }, 500);
    }
  </script>
</body>
</html>
