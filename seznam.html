<!-- üü£üü£üü£ WGS SEZNAM REKLAMAC√ç ‚Äì DARK NEON STYLE (ƒç√°st 1/3) -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Seznam reklamac√≠ ‚Äì White Glove Service</title>

<!-- üåç MAPA -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* üåå Z√ÅKLADN√ç POZAD√ç */
body {
  margin:0;
  font-family:"Inter",system-ui,sans-serif;
  background:radial-gradient(circle at center,#1a1a2e 0%,#0f0f1a 45%,#000 100%);
  color:#e0e0ff;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* ü™û WRAPPER */
.wrapper{
  width:100%;
  max-width:1200px;
  background:rgba(20,20,40,0.6);
  border:1px solid rgba(100,100,255,0.2);
  backdrop-filter:blur(12px);
  border-radius:18px;
  box-shadow:
    0 0 20px rgba(80,0,255,0.3),
    inset 0 0 25px rgba(0,0,100,0.2);
  margin:40px 15px;
  padding:25px 20px 40px;
  box-sizing:border-box;
}

/* üî± HLAVIƒåKA */
h1{
  text-align:center;
  font-size:2.4em;
  font-weight:900;
  color:#9d8cff;
  text-shadow:0 0 8px rgba(160,140,255,0.6),0 0 25px rgba(90,70,255,0.4);
  margin:0 0 8px;
  letter-spacing:0.5px;
}
h2{
  text-align:center;
  color:#7fd0ff;
  font-weight:500;
  font-size:1em;
  letter-spacing:2px;
  margin:0 0 30px;
  text-transform:uppercase;
}
@keyframes glowPulse{
  0%,100%{opacity:1;text-shadow:0 0 15px rgba(140,120,255,0.4);}
  50%{opacity:.9;text-shadow:0 0 30px rgba(160,120,255,0.8);}
}
h1,h2{animation:glowPulse 4s ease-in-out infinite;}

/* üîò TLAƒå√çTKA */
.actions{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:14px;
  margin-bottom:30px;
}
.btn{
  padding:12px 26px;
  border:none;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
  letter-spacing:0.5px;
  font-size:1em;
  text-decoration:none;
  color:#fff;
  transition:transform .2s,box-shadow .3s;
}
.btn:hover{transform:translateY(-2px);}

/* üü£ Zpƒõt */
.btn-back{
  background:linear-gradient(135deg,#4b3bff,#7a5cff);
  box-shadow:0 0 15px rgba(120,90,255,0.4);
}
.btn-back:hover{box-shadow:0 0 25px rgba(150,110,255,0.6);}

/* üîµ Naƒç√≠st znovu */
.btn-refresh{
  background:linear-gradient(135deg,#0090ff,#33b5ff);
  box-shadow:0 0 15px rgba(0,180,255,0.35);
}
.btn-refresh:hover{box-shadow:0 0 25px rgba(0,180,255,0.6);}

/* üü¢ Hotov√© reklamace */
.btn-green{
  background:linear-gradient(135deg,#00c774,#00ff99);
  box-shadow:0 0 15px rgba(0,255,180,0.35);
}
.btn-green:hover{box-shadow:0 0 25px rgba(0,255,180,0.6);}

/* üî∑ Pl√°n dne */
.btn-plan{
  background:linear-gradient(135deg,#0066ff,#33aaff);
  box-shadow:0 0 15px rgba(0,120,255,0.4);
}
.btn-plan:hover{box-shadow:0 0 25px rgba(0,150,255,0.6);}

/* üìã TABULKA ‚Äì tmav√Ω minimalistick√Ω styl */
table {
  width:100%;
  border-collapse:collapse;
  background:rgba(255,255,255,0.03);
  border-radius:10px;
  overflow:hidden;
  box-shadow:0 0 20px rgba(0,0,80,0.25);
}
th,td {
  padding:12px 10px;
  text-align:left;
  font-size:0.95em;
  border-bottom:1px solid rgba(120,120,255,0.1);
}
th {
  background:rgba(60,60,120,0.5);
  color:#a8b9ff;
  text-transform:uppercase;
  font-weight:700;
  letter-spacing:0.5px;
}
tr:hover{background:rgba(120,120,255,0.08);}
</style>
</head>

<body>
<div class="wrapper">
  <h1>WGS</h1>
  <h2>Seznam reklamac√≠</h2>

  <div class="actions">
    <a href="index.html" class="btn btn-back">Zpƒõt</a>
    <button id="reloadBtn" class="btn btn-refresh">Naƒç√≠st znovu</button>
    <a href="hotove.html" class="btn btn-green">Hotov√© reklamace</a>
    <button id="planBtn" class="btn btn-plan">Pl√°n dne</button>
  </div>

<!-- üü¶üü¶üü¶üü¶üü¶ ZAƒå√ÅTEK MODERN√çHO DETAILU Z√ÅKAZN√çKA -->
<style>
#detailModal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,30,0.8);
  backdrop-filter: blur(12px);
  display: none;
  justify-content: center;
  align-items: flex-start;
  z-index: 9000;
  padding-top: 40px;
}
#detailModal.active { display: flex; }

.detail-box {
  width: 94%;
  max-width: 950px;
  background: radial-gradient(circle at top left, #0d0d1a, #05050a);
  border-radius: 18px;
  box-shadow: 0 0 25px rgba(0,255,255,0.2);
  color: #e5e9ff;
  padding: 25px 30px;
  overflow-y: auto;
  max-height: 90vh;
}
.detail-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(0,255,255,0.2);
  margin-bottom: 10px;
}
.detail-close {
  background: linear-gradient(135deg,#ff4a4a,#e60073);
  color:#fff;
  border:none;
  border-radius:10px;
  padding:8px 14px;
  font-weight:600;
  cursor:pointer;
  box-shadow:0 0 15px rgba(255,0,100,0.4);
  transition:all .25s ease;
}
.detail-close:hover { transform:scale(1.07); }

.detail-grid {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  margin-top: 15px;
}
.detail-info { flex: 1 1 380px; }
.detail-map { flex: 1 1 380px; min-height: 250px; border-radius: 12px; overflow: hidden; }

.detail-section {
  margin-top: 15px;
  padding: 10px;
  background: rgba(255,255,255,0.03);
  border-radius: 8px;
}
.detail-section h4 { margin: 0 0 6px; color: #7fd0ff; }

.detail-photos { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 8px; }
.detail-photos img {
  width: 150px; height: 100px; object-fit: cover;
  border-radius: 8px; cursor: pointer; transition: transform .2s;
}
.detail-photos img:hover { transform: scale(1.05); }

/* üß≠ Waze + Telefon */
.btn-waze, .btn-call, .btn-photos {
  display:inline-flex; align-items:center; gap:6px;
  padding:10px 16px; border:none; border-radius:8px;
  font-weight:600; cursor:pointer; text-decoration:none;
  transition:transform .2s, box-shadow .2s;
  margin-right:10px; margin-top:8px;
}
.btn-waze {
  background:linear-gradient(135deg,#0077ff,#00aaff);
  color:#fff; box-shadow:0 0 15px rgba(0,150,255,0.4);
}
.btn-waze:hover { transform:scale(1.05); box-shadow:0 0 25px rgba(0,150,255,0.6); }

.btn-call {
  background:linear-gradient(135deg,#00d87d,#00ff9c);
  color:#000; box-shadow:0 0 15px rgba(0,255,150,0.3);
}
.btn-call:hover { transform:scale(1.05); box-shadow:0 0 25px rgba(0,255,150,0.6); }

.btn-photos {
  background:linear-gradient(135deg,#00b56a,#00ff99);
  color:#000; box-shadow:0 0 15px rgba(0,255,120,0.4);
}
.btn-photos:hover { transform:scale(1.05); box-shadow:0 0 25px rgba(0,255,120,0.6); }

/* üì± Mobil */
@media (max-width: 800px) {
  .detail-grid { flex-direction: column; }
  .detail-map { order: 5; }
}
</style>

<div id="detailModal">
  <div class="detail-box">
    <div class="detail-header">
      <h3 id="detailName">Z√°kazn√≠k</h3>
      <button class="detail-close" onclick="closeDetail()">Zav≈ô√≠t</button>
    </div>

    <div class="detail-grid">
      <div class="detail-info">
        <p><strong>Adresa:</strong> <span id="detailAddress">‚Äì</span></p>
        <p>
          <strong>Telefon:</strong> <a id="detailPhone" href="#" style="color:#00ffcc;text-decoration:none;">‚Äì</a>
        </p>

        <div class="detail-section">
          <h4>Popis z√°vady</h4>
          <div id="detailDesc">‚Äì</div>
        </div>

        <div class="detail-section" id="photoSection" style="display:none;">
          <h4>Fotodokumentace</h4>
          <button class="btn-photos" id="photoBtn">üì∑ Zobrazit fotografie</button>
          <div class="detail-photos" id="detailPhotos"></div>
        </div>

        <div class="detail-section">
          <h4>Vzd√°lenost</h4>
          <div id="detailDistance">üìç Poƒç√≠t√°m vzd√°lenost‚Ä¶</div>
        </div>

        <div style="margin-top:15px;">
          <a id="wazeLink" target="_blank" class="btn-waze">üß≠ Otev≈ô√≠t ve Waze</a>
          <a id="callLink" class="btn-call">üìû Volat</a>
        </div>
      </div>

      <div class="detail-map" id="detailMap"></div>
    </div>
  </div>
</div>

<script>
const WGS_HOME = [50.08031890414999, 14.59812450867171];
let map, marker;

// üü¶ Otev≈ôen√≠ detailu z√°kazn√≠ka
async function openDetail(item) {
  const name = item.zakaznik || "‚Äì";
  const addr = item.adresa || "";
  const phone = item.telefon || "";
  const desc = item.popis || "‚Äì";

  document.getElementById("detailName").textContent = name;
  document.getElementById("detailAddress").textContent = addr;
  document.getElementById("detailPhone").textContent = phone || "‚Äì";
  document.getElementById("detailPhone").href = phone ? `tel:${phone}` : "#";
  document.getElementById("detailDesc").textContent = desc;
  document.getElementById("detailModal").classList.add("active");

  // üß≠ Waze + Telefon odkazy
  const wazeURL = `https://waze.com/ul?q=${encodeURIComponent(addr)}`;
  document.getElementById("wazeLink").href = wazeURL;
  document.getElementById("callLink").href = phone ? `tel:${phone}` : "#";

  // üì∑ Fotky
  const photoSection = document.getElementById("photoSection");
  const photoContainer = document.getElementById("detailPhotos");
  photoContainer.innerHTML = "";
  if (Array.isArray(item.fotky) && item.fotky.length > 0) {
    item.fotky.forEach(src => {
      if (!src) return;
      const img = document.createElement("img");
      img.src = src;
      img.onclick = () => window.open(src, "_blank");
      photoContainer.appendChild(img);
    });
    photoSection.style.display = "block";
  } else {
    photoSection.style.display = "none";
  }

  // üó∫Ô∏è Mapa
  setTimeout(() => {
    if (!map) {
      map = L.map("detailMap").setView(WGS_HOME, 10);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { attribution: "" }).addTo(map);
    }
    if (marker) map.removeLayer(marker);
    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(addr)}`)
      .then(r => r.json())
      .then(res => {
        if (res && res[0]) {
          const lat = parseFloat(res[0].lat);
          const lon = parseFloat(res[0].lon);
          marker = L.marker([lat, lon]).addTo(map);
          map.setView([lat, lon], 12);
          const dist = getDistanceKm(WGS_HOME, [lat, lon]);
          document.getElementById("detailDistance").textContent = `${dist.toFixed(1)} km od WGS`;
        } else {
          document.getElementById("detailDistance").textContent = "Nelze zjistit polohu.";
        }
      })
      .catch(() => {
        document.getElementById("detailDistance").textContent = "Chyba p≈ôi naƒç√≠t√°n√≠ mapy.";
      });
  }, 300);

  // üì∑ Otev≈ôen√≠ fotodokumentace
  document.getElementById("photoBtn").onclick = () => {
    if (!item.cislo) { alert("Chyb√≠ ƒç√≠slo reklamace."); return; }
    window.open(`photocustomer.html?cislo=${encodeURIComponent(item.cislo)}`, "_blank");
  };
}

// üìè V√Ωpoƒçet vzd√°lenosti (Haversine)
function getDistanceKm([lat1, lon1], [lat2, lon2]) {
  const R = 6371;
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLon = (lon2 - lon1) * Math.PI / 180;
  const a = Math.sin(dLat / 2) ** 2 +
            Math.cos(lat1 * Math.PI / 180) *
            Math.cos(lat2 * Math.PI / 180) *
            Math.sin(dLon / 2) ** 2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
}

// üü¶ Zav≈ôen√≠
function closeDetail() {
  document.getElementById("detailModal").classList.remove("active");
}
</script>
<!-- üü¶üü¶üü¶üü¶üü¶ KONEC MODERN√çHO DETAILU Z√ÅKAZN√çKA -->



<!-- üü© TABULKA SEZNAMU -->
<style>
/* üü¶ STAVY ≈ò√ÅDK≈Æ */
tr.new td {background:rgba(255,240,120,0.08);color:#fff176;}
tr.new td:first-child::before{content:"üü° ";}

tr.done td {background:rgba(0,180,255,0.08);color:#66ccff;}
tr.done td:first-child::before{content:"üîµ ";}

tr.cancelled td {background:rgba(255,80,80,0.08);color:#ff8080;}
tr.cancelled td:first-child::before{content:"üî¥ ";}
</style>

<table id="ordersTable">
  <thead>
    <tr>
      <th>Z√°kazn√≠k</th>
      <th>Adresa</th>
      <th>Telefon</th>
      <th>Stav</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="4" style="text-align:center;padding:25px;">Naƒç√≠t√°m data...</td></tr>
  </tbody>
</table>

<script>
const tableBody=document.querySelector("#ordersTable tbody");
const reloadBtn=document.getElementById("reloadBtn");
let allOrders=[];

/* üü© NAƒåTEN√ç DAT Z WORKERU */
async function loadOrders(){
  try{
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#888;">üîÑ Naƒç√≠t√°m data...</td></tr>`;
    const base="https://wgs-token.72nvwf4pb2.workers.dev";
    const urls=[`${base}/orders`, `${base}/hotove`, `${base}/temporaryfiles`];
    const results=await Promise.all(
      urls.map(u=>fetch(u+"?"+Date.now())
      .then(r=>r.json())
      .catch(()=>[]))
    );
    allOrders = results.flat().filter(Boolean);
    renderOrders();
  }catch(e){
    console.error("‚ùå Chyba naƒç√≠t√°n√≠:", e);
    tableBody.innerHTML = `<tr><td colspan="4" style="text-align:center;color:#f66;">Chyba naƒç√≠t√°n√≠ dat</td></tr>`;
  }
}

/* üü© VYKRESLEN√ç TABULKY */
function renderOrders(){
  if(!allOrders.length){
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#999;">≈Ω√°dn√© z√°znamy</td></tr>`;
    return;
  }
  tableBody.innerHTML = allOrders.map(o => {
    const item = o.data || o;
    const stav = (item.stav || "").toLowerCase();
    let cls = "";
    if (stav.includes("nov")) cls = "new";
    else if (stav.includes("domlu")) cls = "done";
    else if (stav.includes("zru")) cls = "cancelled";
    return `
      <tr class="${cls}" onclick='openDetail(${JSON.stringify(item)})'>
        <td>${item.zakaznik || "‚Äì"}</td>
        <td>${item.adresa || "‚Äì"}</td>
        <td>${item.telefon || "‚Äì"}</td>
        <td>${item.stav || "‚Äì"}</td>
      </tr>`;
  }).join("");
}

/* üîÅ TLAƒå√çTKO NAƒå√çST ZNOVU */
reloadBtn.onclick=loadOrders;

/* üöÄ START */
window.addEventListener("DOMContentLoaded",loadOrders);
</script>
<!-- üü£üü£üü£ WGS SEZNAM REKLAMAC√ç ‚Äì DARK NEON STYLE (ƒç√°st 3/3 ‚Äì Z√ÅVƒöR) -->
<style>
/* ‚ú® ANIMOVAN√â POZAD√ç */
body::before{
  content:"";
  position:fixed;inset:0;
  background:
    radial-gradient(circle at 20% 30%,rgba(0,255,180,0.08),transparent 60%),
    radial-gradient(circle at 80% 70%,rgba(120,0,255,0.08),transparent 60%),
    radial-gradient(circle at 50% 50%,rgba(0,128,255,0.05),transparent 70%);
  z-index:-1;
  animation:neonFlow 15s ease-in-out infinite alternate;
}
@keyframes neonFlow{
  0%{filter:hue-rotate(0deg);}
  50%{filter:hue-rotate(80deg);}
  100%{filter:hue-rotate(0deg);}
}

/* üü© TOOLTIP */
.tooltip{
  position:absolute;
  background:rgba(0,0,0,0.8);
  color:#9fffc7;
  padding:6px 10px;
  border-radius:6px;
  font-size:0.8em;
  pointer-events:none;
  opacity:0;
  transition:opacity .2s,transform .2s;
  transform:translateY(-6px);
  z-index:9999;
}
.tooltip.show{
  opacity:1;
  transform:translateY(0);
  box-shadow:0 0 12px rgba(0,255,120,0.4);
}

/* üü© NOTIFIKACE */
#notif{
  position:fixed;
  top:18px;left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg,#00b56a,#00ff99);
  color:#000;
  padding:10px 20px;
  border-radius:10px;
  font-weight:700;
  box-shadow:0 0 18px rgba(0,255,120,0.4);
  opacity:0;
  transition:opacity .3s,transform .3s;
  z-index:6000;
}
#notif.show{
  opacity:1;
  transform:translate(-50%,10px);
}
#notif.error{
  background:linear-gradient(135deg,#ff5b5b,#e63946);
  color:#fff;
  box-shadow:0 0 18px rgba(255,80,80,0.5);
}

/* üü™ PODPIS / FOOTER */
.footer{
  text-align:center;
  margin:45px 0 15px;
  font-size:0.85em;
  color:#888;
  text-shadow:0 0 10px rgba(100,100,255,0.2);
}
.footer span{
  color:#9d8cff;
  font-weight:600;
}
</style>

<div id="notif"></div>

<div class="footer">
  ¬© 2025 <span>White Glove Service s.r.o.</span> ¬∑ Neon WGS Interface v 2.0
</div>

<script>
/* üü© FUNKCE ‚Äì NOTIFIKACE */
function showNotif(type="ok",text="Hotovo"){
  const n=document.getElementById("notif");
  n.textContent=text;
  n.className=type==="error"?"error show":"show";
  clearTimeout(window._notifTimer);
  window._notifTimer=setTimeout(()=>n.classList.remove("show"),2500);
}

/* üü© FUNKCE ‚Äì TOOLTIP */
let tooltip;
document.addEventListener("mouseover",e=>{
  const t=e.target.closest("[data-tip]");
  if(!t)return;
  tooltip=document.createElement("div");
  tooltip.className="tooltip";
  tooltip.textContent=t.dataset.tip;
  document.body.appendChild(tooltip);
  const r=t.getBoundingClientRect();
  tooltip.style.left=r.left+r.width/2+"px";
  tooltip.style.top=r.top-30+"px";
  requestAnimationFrame(()=>tooltip.classList.add("show"));
});
document.addEventListener("mouseout",()=>{
  if(tooltip){tooltip.remove();tooltip=null;}
});

/* üü© P≈òESMƒöROV√ÅN√ç NA PL√ÅN DNE */
const planBtn=document.getElementById("planBtn");
if(planBtn){
  planBtn.addEventListener("click",()=>{
    sessionStorage.setItem("fromPlanDne","1");
    window.location.href="plandne.html";
  });
}

/* üü© OBNOVEN√ç SEZNAMU PO N√ÅVRATU Z PL√ÅNU DNE */
window.addEventListener("DOMContentLoaded",()=>{
  if(sessionStorage.getItem("fromPlanDne")==="1"){
    sessionStorage.removeItem("fromPlanDne");
    if(typeof loadOrders==="function") loadOrders();
    showNotif("ok","Seznam obnoven po n√°vratu z Pl√°nu dne");
  }
});
</script>
</div>
</body>
</html>
