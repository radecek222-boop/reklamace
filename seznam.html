<!doctype html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WHITE GLOVE SERVICE ‚Äì Seznam reklamac√≠</title>
<style>
:root { font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif; color:#111; }
body { margin:0; padding:20px; background:#f6f7fb; }
h1 { text-align:center; font-size:2em; font-weight:900; margin:0 0 10px; }
h2 { text-align:center; font-size:1.1em; font-weight:600; margin:0 0 20px; color:#555; }

.btn-gradient {
  display:inline-block; text-decoration:none; padding:10px 22px; border-radius:8px;
  font-weight:600; font-size:1em; color:#fff; border:none; cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,0.15);
  transition:transform 0.15s ease-in-out, opacity 0.2s; margin:4px;
}
.btn-gradient:hover { transform:scale(1.04); opacity:0.9; }
.btn-green { background:linear-gradient(135deg,#00b36b,#3cd67a); }
.btn-gray { background:linear-gradient(135deg,#6c757d,#a0a4a7); }
.btn-blue { background:linear-gradient(135deg,#0046ff,#357aff); }

.top-actions { text-align:center; margin-bottom:20px; }
.searchbox {
  width:100%; max-width:400px; margin:0 auto 20px; display:block;
  padding:10px; border:1px solid #ccc; border-radius:8px; font-size:1em; background:#fff;
}

table { width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; }
th, td { padding:10px 12px; text-align:left; border-bottom:1px solid #ddd; font-size:0.95em; }
th { background:#eee; font-weight:700; }
tr:hover { background:#f1f3f5; cursor:pointer; }

@keyframes blinkYellow { 50% { background:linear-gradient(135deg,#fff8b3,#ffe680); } }
@keyframes blinkOrange { 50% { background:linear-gradient(135deg,#ffd9b3,#ffcc80); } }

.row-new { background:linear-gradient(135deg,#fff7a1,#fff1b0); animation:blinkYellow 1.5s infinite; }
.row-nezveda { background:linear-gradient(135deg,#ffcc80,#ffb84d); animation:blinkOrange 1.5s infinite; }
.row-termin { background:linear-gradient(135deg,#cce0ff,#99ccff); }
.row-hotovo { background:linear-gradient(135deg,#a3e6b3,#66cc99); }

.badge-poz {
  background:#6c757d; color:white; font-size:0.8em; padding:2px 6px; border-radius:6px; margin-right:6px;
}

@media (max-width:768px){ th:nth-child(n+5), td:nth-child(n+5){display:none;} }

#detailModal { display:none; }
</style>
</head>
<body>
<h1>WHITE GLOVE SERVICE</h1>
<h2>Seznam reklamac√≠ a servisn√≠ch po≈æadavk≈Ø</h2>

<div class="top-actions">
  <a href="index.html" class="btn-gradient btn-gray">Zpƒõt na hlavn√≠ str√°nku</a>
  <a href="hotove.html" class="btn-gradient btn-green">Hotov√© reklamace</a>
  <button onclick="loadAll()" class="btn-gradient btn-blue">Naƒç√≠st znovu</button>
</div>

<input type="text" id="searchInput" class="searchbox" placeholder="Hledat podle jm√©na, adresy nebo telefonu...">

<table id="dataTable">
<thead>
<tr><th>Z√ÅKAZN√çK</th><th>ADRESA</th><th>TELEFON</th><th>STAV</th></tr>
</thead>
<tbody id="tableBody"><tr><td colspan="4" style="text-align:center;padding:20px;">Naƒç√≠t√°n√≠ dat...</td></tr></tbody>
</table>

<script>
const GITHUB_USER="radecek222-boop",REPO="reklamace";
const FILES=["orders.json","aftersales.json","hotove.json"];

async function fetchJson(file){
  try{
    const res=await fetch(`https://raw.githubusercontent.com/${GITHUB_USER}/${REPO}/main/${file}?${Date.now()}`);
    if(!res.ok) throw new Error(res.statusText);
    const data=await res.json();
    return data.map(x=>({...x,source:file.replace('.json','')}));
  }catch(e){
    console.error("Chyba p≈ôi naƒç√≠t√°n√≠",file,e);
    return [];
  }
}

async function loadAll(){
  const tbody=document.getElementById("tableBody");
  tbody.innerHTML=`<tr><td colspan="4" style="text-align:center;padding:20px;">Naƒç√≠t√°n√≠...</td></tr>`;
  try{
    const results=await Promise.all(FILES.map(f=>fetchJson(f)));
    let all=results.flat();

    // se≈ôadit podle ƒçasu (pokud maj√≠ datum)
    all.sort((a,b)=>(new Date(b["Datum vytvo≈ôen√≠"]||0))-(new Date(a["Datum vytvo≈ôen√≠"]||0)));

    renderTable(all);
  }catch(e){
    tbody.innerHTML=`<tr><td colspan="4" style="color:red;text-align:center;">Chyba: ${e.message}</td></tr>`;
  }
}

function renderTable(data){
  const tbody=document.getElementById("tableBody");
  tbody.innerHTML="";

  const search=document.getElementById("searchInput").value.toLowerCase();

  const filtered=data.filter(d=>{
    return (
      (d["Z√°kazn√≠k"]||"").toLowerCase().includes(search) ||
      (d["Adresa"]||"").toLowerCase().includes(search) ||
      (d["Telefon"]||"").toLowerCase().includes(search)
    );
  });

  if(filtered.length===0){
    tbody.innerHTML=`<tr><td colspan="4" style="text-align:center;padding:20px;">≈Ω√°dn√© v√Ωsledky</td></tr>`;
    return;
  }

  filtered.forEach(item=>{
    const tr=document.createElement("tr");
    const stav=(item["Stav"]||"").toLowerCase();

    if(stav.includes("nezved√°")) tr.classList.add("row-nezveda");
    else if(stav.includes("term√≠n")) tr.classList.add("row-termin");
    else if(stav.includes("hotovo")) tr.classList.add("row-hotovo");
    else tr.classList.add("row-new");

    let nameCell=item["Z√°kazn√≠k"]||"";
    if(item.source==="aftersales") nameCell=`<span class="badge-poz">POZ</span>${nameCell}`;

    const wazeLink=item["Adresa"]?`<a href="https://waze.com/ul?q=${encodeURIComponent(item["Adresa"])}" target="_blank">${item["Adresa"]}</a>`:"";
    const phoneLink=item["Telefon"]?`<a href="tel:${item["Telefon"].replace(/\s+/g,'')}" style="text-decoration:none;color:#0046ff;">üìû ${item["Telefon"]}</a>`:"";

    tr.innerHTML=`
      <td>${nameCell}</td>
      <td>${wazeLink}</td>
      <td>${phoneLink}</td>
      <td>${item["Stav"]||"Nov√°"}</td>
    `;
    tbody.appendChild(tr);
  });
}

document.getElementById("searchInput").addEventListener("input",()=>loadAll());
window.addEventListener("pageshow",loadAll);
loadAll();
</script>
</body>
</html>
