<!-- üü£üü£üü£ WGS SEZNAM REKLAMAC√ç ‚Äì DARK NEON STYLE (ƒç√°st 1/3) -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Seznam reklamac√≠ ‚Äì White Glove Service</title>

<!-- üåç MAPA -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* üåå Z√ÅKLADN√ç POZAD√ç */
body {
  margin:0;
  font-family:"Inter",system-ui,sans-serif;
  background:radial-gradient(circle at center,#1a1a2e 0%,#0f0f1a 45%,#000 100%);
  color:#e0e0ff;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* ü™û WRAPPER */
.wrapper{
  width:100%;
  max-width:1200px;
  background:rgba(20,20,40,0.6);
  border:1px solid rgba(100,100,255,0.2);
  backdrop-filter:blur(12px);
  border-radius:18px;
  box-shadow:
    0 0 20px rgba(80,0,255,0.3),
    inset 0 0 25px rgba(0,0,100,0.2);
  margin:40px 15px;
  padding:25px 20px 40px;
  box-sizing:border-box;
}

/* üî± HLAVIƒåKA */
h1{
  text-align:center;
  font-size:2.4em;
  font-weight:900;
  color:#9d8cff;
  text-shadow:0 0 8px rgba(160,140,255,0.6),0 0 25px rgba(90,70,255,0.4);
  margin:0 0 8px;
  letter-spacing:0.5px;
}
h2{
  text-align:center;
  color:#7fd0ff;
  font-weight:500;
  font-size:1em;
  letter-spacing:2px;
  margin:0 0 30px;
  text-transform:uppercase;
}
@keyframes glowPulse{
  0%,100%{opacity:1;text-shadow:0 0 15px rgba(140,120,255,0.4);}
  50%{opacity:.9;text-shadow:0 0 30px rgba(160,120,255,0.8);}
}
h1,h2{animation:glowPulse 4s ease-in-out infinite;}

/* üîò TLAƒå√çTKA */
.actions{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:14px;
  margin-bottom:30px;
}
.btn{
  padding:12px 26px;
  border:none;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
  letter-spacing:0.5px;
  font-size:1em;
  text-decoration:none;
  color:#fff;
  transition:transform .2s,box-shadow .3s;
}
.btn:hover{transform:translateY(-2px);}

/* üü£ Zpƒõt */
.btn-back{
  background:linear-gradient(135deg,#4b3bff,#7a5cff);
  box-shadow:0 0 15px rgba(120,90,255,0.4);
}
.btn-back:hover{box-shadow:0 0 25px rgba(150,110,255,0.6);}

/* üîµ Naƒç√≠st znovu */
.btn-refresh{
  background:linear-gradient(135deg,#0090ff,#33b5ff);
  box-shadow:0 0 15px rgba(0,180,255,0.35);
}
.btn-refresh:hover{box-shadow:0 0 25px rgba(0,180,255,0.6);}

/* üü¢ Hotov√© reklamace */
.btn-green{
  background:linear-gradient(135deg,#00c774,#00ff99);
  box-shadow:0 0 15px rgba(0,255,180,0.35);
}
.btn-green:hover{box-shadow:0 0 25px rgba(0,255,180,0.6);}

/* üî∑ Pl√°n dne */
.btn-plan{
  background:linear-gradient(135deg,#0066ff,#33aaff);
  box-shadow:0 0 15px rgba(0,120,255,0.4);
}
.btn-plan:hover{box-shadow:0 0 25px rgba(0,150,255,0.6);}

/* üìã TABULKA ‚Äì tmav√Ω minimalistick√Ω styl */
table {
  width:100%;
  border-collapse:collapse;
  background:rgba(255,255,255,0.03);
  border-radius:10px;
  overflow:hidden;
  box-shadow:0 0 20px rgba(0,0,80,0.25);
}
th,td {
  padding:12px 10px;
  text-align:left;
  font-size:0.95em;
  border-bottom:1px solid rgba(120,120,255,0.1);
}
th {
  background:rgba(60,60,120,0.5);
  color:#a8b9ff;
  text-transform:uppercase;
  font-weight:700;
  letter-spacing:0.5px;
}
tr:hover{background:rgba(120,120,255,0.08);}
</style>
</head>

<body>
<div class="wrapper">
  <h1>WGS</h1>
  <h2>Seznam reklamac√≠</h2>

  <div class="actions">
    <a href="index.html" class="btn btn-back">Zpƒõt</a>
    <button id="reloadBtn" class="btn btn-refresh">Naƒç√≠st znovu</button>
    <a href="hotove.html" class="btn btn-green">Hotov√© reklamace</a>
    <button id="planBtn" class="btn btn-plan">Pl√°n dne</button>
  </div>

<!-- üü¶üü¶üü¶ DETAIL Z√ÅKAZN√çKA ‚Äì VERZE S LIGHTBOXEM A ZAROVNAN√ùMI TLAƒå√çTKY -->
<style>
#detailModal {
  position:fixed;inset:0;
  background:rgba(0,0,30,0.8);
  backdrop-filter:blur(12px);
  display:none;justify-content:center;align-items:flex-start;
  z-index:9000;padding-top:40px;
}
#detailModal.active{display:flex;}
.detail-box{
  width:94%;max-width:900px;
  background:radial-gradient(circle at top left,#0d0d1a,#05050a);
  border-radius:18px;box-shadow:0 0 25px rgba(0,255,255,0.2);
  color:#e5e9ff;padding:25px 30px;overflow-y:auto;max-height:90vh;
}
.detail-header{
  display:flex;justify-content:space-between;align-items:center;
  border-bottom:1px solid rgba(0,255,255,0.2);margin-bottom:10px;
}
.detail-close{
  background:linear-gradient(135deg,#ff4a4a,#e60073);
  color:#fff;border:none;border-radius:10px;
  padding:8px 14px;font-weight:600;cursor:pointer;
  box-shadow:0 0 15px rgba(255,0,100,0.4);
}
.detail-grid{display:flex;flex-wrap:wrap;gap:25px;margin-top:15px;}
.detail-info{flex:1 1 400px;}
.detail-map{flex:1 1 400px;min-height:250px;border-radius:12px;overflow:hidden;}
.detail-section{margin-top:15px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;}
.detail-section h4{margin:0 0 6px;color:#7fd0ff;display:flex;justify-content:space-between;align-items:center;}

/* üü© UNIFIKOVAN√Å TLAƒå√çTKA */
.detail-buttons{
  display:flex;gap:10px;margin-top:15px;
  justify-content:space-between;
}
.detail-buttons a{
  flex:1;text-align:center;height:44px;display:flex;align-items:center;justify-content:center;
  border:none;border-radius:10px;font-weight:600;font-size:0.95em;
  transition:transform .2s,box-shadow .2s;text-decoration:none;
}
.btn-waze{
  background:linear-gradient(135deg,#0077ff,#00aaff);
  color:#fff;box-shadow:0 0 15px rgba(0,150,255,0.4);
}
.btn-call{
  background:linear-gradient(135deg,#00d87d,#00ff9c);
  color:#000;box-shadow:0 0 15px rgba(0,255,150,0.3);
}
.btn-waze:hover,.btn-call:hover{transform:scale(1.04);box-shadow:0 0 25px rgba(0,255,255,0.6);}

/* üü¶ Fotky */
.btn-photos{
  background:linear-gradient(135deg,#00b56a,#00ff99);
  color:#000;border:none;border-radius:8px;
  padding:6px 14px;font-weight:600;cursor:pointer;
  box-shadow:0 0 15px rgba(0,255,120,0.4);
}
.btn-photos.disabled{
  background:rgba(100,100,100,0.3);color:#aaa;box-shadow:none;cursor:default;
}

/* üüß Lightbox */
#photoLightbox{
  position:fixed;inset:0;background:rgba(0,0,0,0.95);
  display:none;flex-direction:column;justify-content:center;align-items:center;
  z-index:9999;
}
#photoLightbox.active{display:flex;}
#photoLightbox img{
  max-width:90%;max-height:80vh;object-fit:contain;border-radius:8px;
}
.lightbox-nav{
  margin-top:15px;display:flex;gap:20px;align-items:center;
}
.lightbox-btn{
  background:linear-gradient(135deg,#00bfa5,#00ffcc);
  color:#000;border:none;border-radius:8px;
  padding:8px 18px;font-weight:700;cursor:pointer;
  box-shadow:0 0 12px rgba(0,255,200,0.5);
}
.lightbox-btn:hover{transform:scale(1.05);}
</style>

<div id="detailModal">
  <div class="detail-box">
    <div class="detail-header">
      <h3 id="detailName">Z√°kazn√≠k</h3>
      <button class="detail-close" onclick="closeDetail()">Zav≈ô√≠t</button>
    </div>

    <div class="detail-grid">
      <div class="detail-info">
        <p><strong>Adresa:</strong> <span id="detailAddress">‚Äì</span></p>
        <p><strong>Telefon:</strong> <a id="detailPhone" href="#" style="color:#00ffcc;text-decoration:none;">‚Äì</a></p>

        <div class="detail-section">
          <h4>
            <span>Popis z√°vady</span>
          </h4>
          <div id="detailDesc">‚Äì</div>
        </div>

        <div class="detail-section">
          <h4>
            <span>Fotodokumentace</span>
            <button id="photoBtn" class="btn-photos">Naƒç√≠t√°m...</button>
          </h4>
        </div>

        <div class="detail-section">
          <h4>Vzd√°lenost</h4>
          <div id="detailDistance">üìç Poƒç√≠t√°m vzd√°lenost‚Ä¶</div>
        </div>

        <div class="detail-buttons">
          <a id="wazeLink" target="_blank" class="btn-waze"> Waze</a>
          <a id="callLink" class="btn-call">Volat</a>
        </div>
      </div>

      <div class="detail-map" id="detailMap"></div>
    </div>
  </div>
</div>

<!-- üñºÔ∏è LIGHTBOX FOTEK -->
<div id="photoLightbox">
  <img id="lightboxImg" src="" alt="">
  <div class="lightbox-nav">
    <button class="lightbox-btn" id="prevPhoto">‚óÄ</button>
    <button class="lightbox-btn" id="nextPhoto">‚ñ∂</button>
    <button class="lightbox-btn" onclick="closeLightbox()">Zav≈ô√≠t</button>
  </div>
</div>

<script>
const WGS_HOME=[50.08031890414999,14.59812450867171];
let map,marker,photosArr=[],currentPhoto=0;

async function openDetail(item){
  const addr=item.adresa||"", phone=item.telefon||"", desc=item.popis||"‚Äì";
  const name=item.zakaznik||"‚Äì", photos=Array.isArray(item.fotky)?item.fotky.filter(f=>f):[];

  document.getElementById("detailName").textContent=name;
  document.getElementById("detailAddress").textContent=addr;
  document.getElementById("detailPhone").textContent=phone||"‚Äì";
  document.getElementById("detailPhone").href=phone?`tel:${phone}`:"#";
  document.getElementById("detailDesc").textContent=desc;
  document.getElementById("detailModal").classList.add("active");

  document.getElementById("wazeLink").href=`https://waze.com/ul?q=${encodeURIComponent(addr)}`;
  document.getElementById("callLink").href=phone?`tel:${phone}`:"#";

  const btn=document.getElementById("photoBtn");
  if(photos.length>0){
    btn.textContent=`üì∑ Zobrazit fotografie (${photos.length})`;
    btn.classList.remove("disabled");
    btn.onclick=()=>openLightbox(photos);
  }else{
    btn.textContent="Nejsou ≈æ√°dn√© fotografie";
    btn.classList.add("disabled");
    btn.onclick=null;
  }

  setTimeout(()=>{
    if(!map){
      map=L.map("detailMap").setView(WGS_HOME,10);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:""}).addTo(map);
    }
    if(marker)map.removeLayer(marker);
    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(addr)}`)
      .then(r=>r.json()).then(res=>{
        if(res&&res[0]){
          const lat=parseFloat(res[0].lat),lon=parseFloat(res[0].lon);
          marker=L.marker([lat,lon]).addTo(map);
          map.setView([lat,lon],12);
          const dist=getDist(WGS_HOME,[lat,lon]);
          document.getElementById("detailDistance").textContent=`${dist.toFixed(1)} km od WGS`;
        }else document.getElementById("detailDistance").textContent="Nelze zjistit polohu.";
      }).catch(()=>document.getElementById("detailDistance").textContent="Chyba p≈ôi naƒç√≠t√°n√≠ mapy.");
  },300);
}

function getDist([a,b],[c,d]){
  const R=6371,dl=(c-a)*Math.PI/180,dn=(d-b)*Math.PI/180;
  const h=Math.sin(dl/2)**2+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(dn/2)**2;
  return R*2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));
}
function closeDetail(){document.getElementById("detailModal").classList.remove("active");}

/* üñºÔ∏è LIGHTBOX */
function openLightbox(arr){
  photosArr=arr;currentPhoto=0;
  document.getElementById("photoLightbox").classList.add("active");
  showPhoto();
}
function showPhoto(){
  document.getElementById("lightboxImg").src=photosArr[currentPhoto];
}
document.getElementById("prevPhoto").onclick=()=>{if(currentPhoto>0){currentPhoto--;showPhoto();}};
document.getElementById("nextPhoto").onclick=()=>{if(currentPhoto<photosArr.length-1){currentPhoto++;showPhoto();}};
function closeLightbox(){
  document.getElementById("photoLightbox").classList.remove("active");
}
</script>
<!-- üü¶üü¶üü¶ KONEC DETAILU Z√ÅKAZN√çKA -->




<!-- üü© TABULKA SEZNAMU -->
<style>
/* üü¶ STAVY ≈ò√ÅDK≈Æ */
tr.new td {background:rgba(255,240,120,0.08);color:#fff176;}
tr.new td:first-child::before{content:"üü° ";}

tr.done td {background:rgba(0,180,255,0.08);color:#66ccff;}
tr.done td:first-child::before{content:"üîµ ";}

tr.cancelled td {background:rgba(255,80,80,0.08);color:#ff8080;}
tr.cancelled td:first-child::before{content:"üî¥ ";}
</style>

<table id="ordersTable">
  <thead>
    <tr>
      <th>Z√°kazn√≠k</th>
      <th>Adresa</th>
      <th>Telefon</th>
      <th>Stav</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="4" style="text-align:center;padding:25px;">Naƒç√≠t√°m data...</td></tr>
  </tbody>
</table>

<script>
const tableBody=document.querySelector("#ordersTable tbody");
const reloadBtn=document.getElementById("reloadBtn");
let allOrders=[];

/* üü© NAƒåTEN√ç DAT Z WORKERU */
async function loadOrders(){
  try{
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#888;">üîÑ Naƒç√≠t√°m data...</td></tr>`;
    const base="https://wgs-token.72nvwf4pb2.workers.dev";
    const urls=[`${base}/orders`, `${base}/hotove`, `${base}/temporaryfiles`];
    const results=await Promise.all(
      urls.map(u=>fetch(u+"?"+Date.now())
      .then(r=>r.json())
      .catch(()=>[]))
    );
    allOrders = results.flat().filter(Boolean);
    renderOrders();
  }catch(e){
    console.error("‚ùå Chyba naƒç√≠t√°n√≠:", e);
    tableBody.innerHTML = `<tr><td colspan="4" style="text-align:center;color:#f66;">Chyba naƒç√≠t√°n√≠ dat</td></tr>`;
  }
}

/* üü© VYKRESLEN√ç TABULKY */
function renderOrders(){
  if(!allOrders.length){
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#999;">≈Ω√°dn√© z√°znamy</td></tr>`;
    return;
  }
  tableBody.innerHTML = allOrders.map(o => {
    const item = o.data || o;
    const stav = (item.stav || "").toLowerCase();
    let cls = "";
    if (stav.includes("nov")) cls = "new";
    else if (stav.includes("domlu")) cls = "done";
    else if (stav.includes("zru")) cls = "cancelled";
    return `
      <tr class="${cls}" onclick='openDetail(${JSON.stringify(item)})'>
        <td>${item.zakaznik || "‚Äì"}</td>
        <td>${item.adresa || "‚Äì"}</td>
        <td>${item.telefon || "‚Äì"}</td>
        <td>${item.stav || "‚Äì"}</td>
      </tr>`;
  }).join("");
}

/* üîÅ TLAƒå√çTKO NAƒå√çST ZNOVU */
reloadBtn.onclick=loadOrders;

/* üöÄ START */
window.addEventListener("DOMContentLoaded",loadOrders);
</script>
<!-- üü£üü£üü£ WGS SEZNAM REKLAMAC√ç ‚Äì DARK NEON STYLE (ƒç√°st 3/3 ‚Äì Z√ÅVƒöR) -->
<style>
/* ‚ú® ANIMOVAN√â POZAD√ç */
body::before{
  content:"";
  position:fixed;inset:0;
  background:
    radial-gradient(circle at 20% 30%,rgba(0,255,180,0.08),transparent 60%),
    radial-gradient(circle at 80% 70%,rgba(120,0,255,0.08),transparent 60%),
    radial-gradient(circle at 50% 50%,rgba(0,128,255,0.05),transparent 70%);
  z-index:-1;
  animation:neonFlow 15s ease-in-out infinite alternate;
}
@keyframes neonFlow{
  0%{filter:hue-rotate(0deg);}
  50%{filter:hue-rotate(80deg);}
  100%{filter:hue-rotate(0deg);}
}

/* üü© TOOLTIP */
.tooltip{
  position:absolute;
  background:rgba(0,0,0,0.8);
  color:#9fffc7;
  padding:6px 10px;
  border-radius:6px;
  font-size:0.8em;
  pointer-events:none;
  opacity:0;
  transition:opacity .2s,transform .2s;
  transform:translateY(-6px);
  z-index:9999;
}
.tooltip.show{
  opacity:1;
  transform:translateY(0);
  box-shadow:0 0 12px rgba(0,255,120,0.4);
}

/* üü© NOTIFIKACE */
#notif{
  position:fixed;
  top:18px;left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg,#00b56a,#00ff99);
  color:#000;
  padding:10px 20px;
  border-radius:10px;
  font-weight:700;
  box-shadow:0 0 18px rgba(0,255,120,0.4);
  opacity:0;
  transition:opacity .3s,transform .3s;
  z-index:6000;
}
#notif.show{
  opacity:1;
  transform:translate(-50%,10px);
}
#notif.error{
  background:linear-gradient(135deg,#ff5b5b,#e63946);
  color:#fff;
  box-shadow:0 0 18px rgba(255,80,80,0.5);
}

/* üü™ PODPIS / FOOTER */
.footer{
  text-align:center;
  margin:45px 0 15px;
  font-size:0.85em;
  color:#888;
  text-shadow:0 0 10px rgba(100,100,255,0.2);
}
.footer span{
  color:#9d8cff;
  font-weight:600;
}
</style>

<div id="notif"></div>

<div class="footer">
  ¬© 2025 <span>White Glove Service s.r.o.</span> ¬∑ Neon WGS Interface v 2.0
</div>

<script>
/* üü© FUNKCE ‚Äì NOTIFIKACE */
function showNotif(type="ok",text="Hotovo"){
  const n=document.getElementById("notif");
  n.textContent=text;
  n.className=type==="error"?"error show":"show";
  clearTimeout(window._notifTimer);
  window._notifTimer=setTimeout(()=>n.classList.remove("show"),2500);
}

/* üü© FUNKCE ‚Äì TOOLTIP */
let tooltip;
document.addEventListener("mouseover",e=>{
  const t=e.target.closest("[data-tip]");
  if(!t)return;
  tooltip=document.createElement("div");
  tooltip.className="tooltip";
  tooltip.textContent=t.dataset.tip;
  document.body.appendChild(tooltip);
  const r=t.getBoundingClientRect();
  tooltip.style.left=r.left+r.width/2+"px";
  tooltip.style.top=r.top-30+"px";
  requestAnimationFrame(()=>tooltip.classList.add("show"));
});
document.addEventListener("mouseout",()=>{
  if(tooltip){tooltip.remove();tooltip=null;}
});

/* üü© P≈òESMƒöROV√ÅN√ç NA PL√ÅN DNE */
const planBtn=document.getElementById("planBtn");
if(planBtn){
  planBtn.addEventListener("click",()=>{
    sessionStorage.setItem("fromPlanDne","1");
    window.location.href="plandne.html";
  });
}

/* üü© OBNOVEN√ç SEZNAMU PO N√ÅVRATU Z PL√ÅNU DNE */
window.addEventListener("DOMContentLoaded",()=>{
  if(sessionStorage.getItem("fromPlanDne")==="1"){
    sessionStorage.removeItem("fromPlanDne");
    if(typeof loadOrders==="function") loadOrders();
    showNotif("ok","Seznam obnoven po n√°vratu z Pl√°nu dne");
  }
});
</script>
</div>
</body>
</html>
