<!-- 🟣🟣🟣 WGS SEZNAM REKLAMACÍ – DARK NEON STYLE (část 1/3) -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Seznam reklamací – White Glove Service</title>

<!-- 🌍 MAPA -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* 🌌 ZÁKLADNÍ POZADÍ */
body {
  margin:0;
  font-family:"Inter",system-ui,sans-serif;
  background:radial-gradient(circle at center,#1a1a2e 0%,#0f0f1a 45%,#000 100%);
  color:#e0e0ff;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* 🪞 WRAPPER */
.wrapper{
  width:100%;
  max-width:1200px;
  background:rgba(20,20,40,0.6);
  border:1px solid rgba(100,100,255,0.2);
  backdrop-filter:blur(12px);
  border-radius:18px;
  box-shadow:
    0 0 20px rgba(80,0,255,0.3),
    inset 0 0 25px rgba(0,0,100,0.2);
  margin:40px 15px;
  padding:25px 20px 40px;
  box-sizing:border-box;
}

/* 🔱 HLAVIČKA */
h1{
  text-align:center;
  font-size:2.4em;
  font-weight:900;
  color:#9d8cff;
  text-shadow:0 0 8px rgba(160,140,255,0.6),0 0 25px rgba(90,70,255,0.4);
  margin:0 0 8px;
  letter-spacing:0.5px;
}
h2{
  text-align:center;
  color:#7fd0ff;
  font-weight:500;
  font-size:1em;
  letter-spacing:2px;
  margin:0 0 30px;
  text-transform:uppercase;
}
@keyframes glowPulse{
  0%,100%{opacity:1;text-shadow:0 0 15px rgba(140,120,255,0.4);}
  50%{opacity:.9;text-shadow:0 0 30px rgba(160,120,255,0.8);}
}
h1,h2{animation:glowPulse 4s ease-in-out infinite;}

/* 🔘 TLAČÍTKA */
.actions{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:14px;
  margin-bottom:30px;
}
.btn{
  padding:12px 26px;
  border:none;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
  letter-spacing:0.5px;
  font-size:1em;
  text-decoration:none;
  color:#fff;
  transition:transform .2s,box-shadow .3s;
}
.btn:hover{transform:translateY(-2px);}

/* 🟣 Zpět */
.btn-back{
  background:linear-gradient(135deg,#4b3bff,#7a5cff);
  box-shadow:0 0 15px rgba(120,90,255,0.4);
}
.btn-back:hover{box-shadow:0 0 25px rgba(150,110,255,0.6);}

/* 🔵 Načíst znovu */
.btn-refresh{
  background:linear-gradient(135deg,#0090ff,#33b5ff);
  box-shadow:0 0 15px rgba(0,180,255,0.35);
}
.btn-refresh:hover{box-shadow:0 0 25px rgba(0,180,255,0.6);}

/* 🟢 Hotové reklamace */
.btn-green{
  background:linear-gradient(135deg,#00c774,#00ff99);
  box-shadow:0 0 15px rgba(0,255,180,0.35);
}
.btn-green:hover{box-shadow:0 0 25px rgba(0,255,180,0.6);}

/* 🔷 Plán dne */
.btn-plan{
  background:linear-gradient(135deg,#0066ff,#33aaff);
  box-shadow:0 0 15px rgba(0,120,255,0.4);
}
.btn-plan:hover{box-shadow:0 0 25px rgba(0,150,255,0.6);}

/* 📋 TABULKA – tmavý minimalistický styl */
table {
  width:100%;
  border-collapse:collapse;
  background:rgba(255,255,255,0.03);
  border-radius:10px;
  overflow:hidden;
  box-shadow:0 0 20px rgba(0,0,80,0.25);
}
th,td {
  padding:12px 10px;
  text-align:left;
  font-size:0.95em;
  border-bottom:1px solid rgba(120,120,255,0.1);
}
th {
  background:rgba(60,60,120,0.5);
  color:#a8b9ff;
  text-transform:uppercase;
  font-weight:700;
  letter-spacing:0.5px;
}
tr:hover{background:rgba(120,120,255,0.08);}
</style>
</head>

<body>
<div class="wrapper">
  <h1>WGS</h1>
  <h2>Seznam reklamací</h2>

  <div class="actions">
    <a href="index.html" class="btn btn-back">Zpět</a>
    <button id="reloadBtn" class="btn btn-refresh">Načíst znovu</button>
    <a href="hotove.html" class="btn btn-green">Hotové reklamace</a>
    <button id="planBtn" class="btn btn-plan">Plán dne</button>
  </div>

<!-- 🟦🟦🟦🟦🟦 ZAČÁTEK MODALU – ÚPRAVA ZÁKAZNÍKA -->
<style>
#editModal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,30,0.8);
  backdrop-filter: blur(10px);
  display: none;
  justify-content: center;
  align-items: flex-start;
  z-index: 9500;
  padding-top: 60px;
}
#editModal.active { display: flex; }

.edit-box {
  width: 94%;
  max-width: 600px;
  background: radial-gradient(circle at top left, #0d0d1a, #05050a);
  border-radius: 16px;
  color: #e5e9ff;
  box-shadow: 0 0 25px rgba(0,255,255,0.2);
  padding: 25px 30px;
  overflow-y: auto;
  max-height: 85vh;
}
.edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(0,255,255,0.25);
  margin-bottom: 10px;
}
.edit-close {
  background: linear-gradient(135deg,#ff4a4a,#e60073);
  color: #fff;
  border:none;
  border-radius:8px;
  padding:6px 12px;
  font-weight:600;
  cursor:pointer;
  transition:transform .2s;
}
.edit-close:hover { transform:scale(1.05); }
.edit-box label {
  display:block;
  font-weight:600;
  margin-top:10px;
  color:#9dcdff;
}
.edit-box input, .edit-box textarea {
  width:100%;
  padding:10px;
  border:none;
  border-radius:8px;
  background:#fff;
  color:#111;
  box-sizing:border-box;
}
.edit-box textarea { min-height:90px; resize:vertical; }
.edit-actions {
  margin-top:18px;
  display:flex;
  justify-content:flex-end;
  gap:12px;
}
.btn-save {
  background:linear-gradient(135deg,#00c774,#00ff99);
  color:#000;
  font-weight:700;
  padding:10px 20px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  transition:transform .2s;
}
.btn-save:hover { transform:scale(1.05); }
</style>

<div id="editModal">
  <div class="edit-box">
    <div class="edit-header">
      <h3>Upravit zákazníka</h3>
      <button class="edit-close" onclick="closeEdit()">Zavřít</button>
    </div>
    <form id="editForm">
      <label>Jméno zákazníka:</label>
      <input type="text" id="editZakaznik">

      <label>Adresa:</label>
      <input type="text" id="editAdresa">

      <label>Telefon:</label>
      <input type="text" id="editTelefon">

      <label>Popis závady:</label>
      <textarea id="editPopis"></textarea>

      <div class="edit-actions">
        <button type="button" class="btn-save" onclick="saveEdit()">💾 Uložit změny</button>
      </div>
    </form>
  </div>
</div>

<script>
let currentEditItem = null;

// 🟦 Otevření modalu pro editaci
function openEditModal(item){
  currentEditItem = item;
  document.getElementById("editZakaznik").value = item.zakaznik || "";
  document.getElementById("editAdresa").value = item.adresa || "";
  document.getElementById("editTelefon").value = item.telefon || "";
  document.getElementById("editPopis").value = item.popis || "";
  document.getElementById("editModal").classList.add("active");
}

// 🟦 Zavření
function closeEdit(){
  document.getElementById("editModal").classList.remove("active");
}

// 🟩 Uložení změn a přepis do seznamu
async function saveEdit(){
  if(!currentEditItem) return;
  const updated = {
    ...currentEditItem,
    zakaznik: document.getElementById("editZakaznik").value.trim(),
    adresa: document.getElementById("editAdresa").value.trim(),
    telefon: document.getElementById("editTelefon").value.trim(),
    popis: document.getElementById("editPopis").value.trim()
  };

  try {
    const base = "https://wgs-token.72nvwf4pb2.workers.dev";
    await fetch(`${base}/orders`, {
      method: "PUT",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(updated)
    });
    showNotif("ok","Záznam upraven");
    closeEdit();
    loadOrders();
  } catch (e) {
    console.error("❌ Chyba při ukládání:", e);
    showNotif("error","Nepodařilo se uložit změny");
  }
}
</script>
<!-- 🟦🟦🟦🟦🟦 KONEC MODALU – ÚPRAVA ZÁKAZNÍKA -->


<!-- 🟩 TABULKA SEZNAMU -->
<style>
/* 🟦 STAVY ŘÁDKŮ */
tr.new td {background:rgba(255,240,120,0.08);color:#fff176;}
tr.new td:first-child::before{content:"🟡 ";}

tr.done td {background:rgba(0,180,255,0.08);color:#66ccff;}
tr.done td:first-child::before{content:"🔵 ";}

tr.cancelled td {background:rgba(255,80,80,0.08);color:#ff8080;}
tr.cancelled td:first-child::before{content:"🔴 ";}
</style>

<table id="ordersTable">
  <thead>
    <tr>
      <th>Zákazník</th>
      <th>Adresa</th>
      <th>Telefon</th>
      <th>Stav</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="4" style="text-align:center;padding:25px;">Načítám data...</td></tr>
  </tbody>
</table>

<script>
const tableBody=document.querySelector("#ordersTable tbody");
const reloadBtn=document.getElementById("reloadBtn");
let allOrders=[];

/* 🟩 NAČTENÍ DAT Z WORKERU */
async function loadOrders(){
  try{
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#888;">🔄 Načítám data...</td></tr>`;
    const base="https://wgs-token.72nvwf4pb2.workers.dev";
    const urls=[`${base}/orders`, `${base}/hotove`, `${base}/temporaryfiles`];
    const results=await Promise.all(
      urls.map(u=>fetch(u+"?"+Date.now())
      .then(r=>r.json())
      .catch(()=>[]))
    );
    allOrders = results.flat().filter(Boolean);
    renderOrders();
  }catch(e){
    console.error("❌ Chyba načítání:", e);
    tableBody.innerHTML = `<tr><td colspan="4" style="text-align:center;color:#f66;">Chyba načítání dat</td></tr>`;
  }
}

/* 🟩 VYKRESLENÍ TABULKY */
function renderOrders(){
  if(!allOrders.length){
    tableBody.innerHTML=`<tr><td colspan="4" style="text-align:center;color:#999;">Žádné záznamy</td></tr>`;
    return;
  }
  tableBody.innerHTML = allOrders.map(o => {
    const item = o.data || o;
    const stav = (item.stav || "").toLowerCase();
    let cls = "";
    if (stav.includes("nov")) cls = "new";
    else if (stav.includes("domlu")) cls = "done";
    else if (stav.includes("zru")) cls = "cancelled";
    return `
      <tr class="${cls}" onclick='openDetail(${JSON.stringify(item)})'>
        <td>${item.zakaznik || "–"}</td>
        <td>${item.adresa || "–"}</td>
        <td>${item.telefon || "–"}</td>
        <td>${item.stav || "–"}</td>
      </tr>`;
  }).join("");
}

/* 🔁 TLAČÍTKO NAČÍST ZNOVU */
reloadBtn.onclick=loadOrders;

/* 🚀 START */
window.addEventListener("DOMContentLoaded",loadOrders);
</script>
<!-- 🟣🟣🟣 WGS SEZNAM REKLAMACÍ – DARK NEON STYLE (část 3/3 – ZÁVĚR) -->
<style>
/* ✨ ANIMOVANÉ POZADÍ */
body::before{
  content:"";
  position:fixed;inset:0;
  background:
    radial-gradient(circle at 20% 30%,rgba(0,255,180,0.08),transparent 60%),
    radial-gradient(circle at 80% 70%,rgba(120,0,255,0.08),transparent 60%),
    radial-gradient(circle at 50% 50%,rgba(0,128,255,0.05),transparent 70%);
  z-index:-1;
  animation:neonFlow 15s ease-in-out infinite alternate;
}
@keyframes neonFlow{
  0%{filter:hue-rotate(0deg);}
  50%{filter:hue-rotate(80deg);}
  100%{filter:hue-rotate(0deg);}
}

/* 🟩 TOOLTIP */
.tooltip{
  position:absolute;
  background:rgba(0,0,0,0.8);
  color:#9fffc7;
  padding:6px 10px;
  border-radius:6px;
  font-size:0.8em;
  pointer-events:none;
  opacity:0;
  transition:opacity .2s,transform .2s;
  transform:translateY(-6px);
  z-index:9999;
}
.tooltip.show{
  opacity:1;
  transform:translateY(0);
  box-shadow:0 0 12px rgba(0,255,120,0.4);
}

/* 🟩 NOTIFIKACE */
#notif{
  position:fixed;
  top:18px;left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg,#00b56a,#00ff99);
  color:#000;
  padding:10px 20px;
  border-radius:10px;
  font-weight:700;
  box-shadow:0 0 18px rgba(0,255,120,0.4);
  opacity:0;
  transition:opacity .3s,transform .3s;
  z-index:6000;
}
#notif.show{
  opacity:1;
  transform:translate(-50%,10px);
}
#notif.error{
  background:linear-gradient(135deg,#ff5b5b,#e63946);
  color:#fff;
  box-shadow:0 0 18px rgba(255,80,80,0.5);
}

/* 🟪 PODPIS / FOOTER */
.footer{
  text-align:center;
  margin:45px 0 15px;
  font-size:0.85em;
  color:#888;
  text-shadow:0 0 10px rgba(100,100,255,0.2);
}
.footer span{
  color:#9d8cff;
  font-weight:600;
}
</style>

<div id="notif"></div>

<div class="footer">
  © 2025 <span>White Glove Service s.r.o.</span> · Neon WGS Interface v 2.0
</div>

<script>
/* 🟩 FUNKCE – NOTIFIKACE */
function showNotif(type="ok",text="Hotovo"){
  const n=document.getElementById("notif");
  n.textContent=text;
  n.className=type==="error"?"error show":"show";
  clearTimeout(window._notifTimer);
  window._notifTimer=setTimeout(()=>n.classList.remove("show"),2500);
}

/* 🟩 FUNKCE – TOOLTIP */
let tooltip;
document.addEventListener("mouseover",e=>{
  const t=e.target.closest("[data-tip]");
  if(!t)return;
  tooltip=document.createElement("div");
  tooltip.className="tooltip";
  tooltip.textContent=t.dataset.tip;
  document.body.appendChild(tooltip);
  const r=t.getBoundingClientRect();
  tooltip.style.left=r.left+r.width/2+"px";
  tooltip.style.top=r.top-30+"px";
  requestAnimationFrame(()=>tooltip.classList.add("show"));
});
document.addEventListener("mouseout",()=>{
  if(tooltip){tooltip.remove();tooltip=null;}
});

/* 🟩 PŘESMĚROVÁNÍ NA PLÁN DNE */
const planBtn=document.getElementById("planBtn");
if(planBtn){
  planBtn.addEventListener("click",()=>{
    sessionStorage.setItem("fromPlanDne","1");
    window.location.href="plandne.html";
  });
}

/* 🟩 OBNOVENÍ SEZNAMU PO NÁVRATU Z PLÁNU DNE */
window.addEventListener("DOMContentLoaded",()=>{
  if(sessionStorage.getItem("fromPlanDne")==="1"){
    sessionStorage.removeItem("fromPlanDne");
    if(typeof loadOrders==="function") loadOrders();
    showNotif("ok","Seznam obnoven po návratu z Plánu dne");
  }
});
</script>
</div>
</body>
</html>
