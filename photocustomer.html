<!-- üü© ZAƒå√ÅTEK ƒå√ÅSTI 1/2 ‚Äì SEKCE 1‚Äì5 -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Photo ‚Äì White Glove Service</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
body {
  font-family:"Inter",sans-serif;
  background:#f6f7fb;
  margin:0;
  padding:0;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
}
.wrapper {
  background:#fff;
  margin:40px 15px;
  padding:30px;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  width:100%;
  max-width:750px;
}
h1 {
  text-align:center;
  font-size:2.4em;
  font-weight:900;
  color:#111;
  margin:0 0 5px;
}
h2 {
  text-align:center;
  font-size:1.1em;
  font-weight:500;
  color:#666;
  margin:0 0 25px;
}
#customerHeader {
  background:#f1f1f1;
  border:1px solid #ccc;
  border-radius:10px;
  padding:18px;
  text-align:center;
  margin-bottom:25px;
}
#customerHeader h3 {
  margin:0 0 4px;
  font-size:1.3em;
  font-weight:700;
  color:#111;
}
#customerHeader p {
  margin:3px 0;
  color:#333;
  font-size:0.95em;
}
.subtitle {
  font-size:0.8em;
  color:#666;
  display:block;
  margin-top:2px;
}
.photo-block {
  border:1px solid #ccc;
  border-radius:10px;
  padding:14px;
  margin-top:18px;
  background:linear-gradient(180deg,#f8f8f8 0%,#ececec 100%);
}
.photo-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}
.photo-header h4 {
  margin:0;
  font-size:1.05em;
  font-weight:700;
  color:#111;
}
.btn-photo {
  background:linear-gradient(135deg,#357aff,#6fa8ff);
  color:#fff;
  font-weight:600;
  border:none;
  border-radius:8px;
  padding:10px 16px;
  cursor:pointer;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  transition:transform .15s ease,opacity .2s;
}
.btn-photo:hover{transform:scale(1.05);opacity:.9;}
.photo-preview {
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.photo-thumb {
  width:90px;
  height:90px;
  border-radius:8px;
  object-fit:cover;
  box-shadow:0 2px 5px rgba(0,0,0,0.15);
  position:relative;
}
.photo-remove {
  position:absolute;
  top:2px;
  right:2px;
  width:22px;
  height:22px;
  border:none;
  border-radius:50%;
  background:rgba(255,255,255,0.95);
  color:#d40000;
  font-weight:bold;
  cursor:pointer;
  line-height:18px;
  font-size:16px;
  box-shadow:0 1px 3px rgba(0,0,0,0.25);
  transition:transform .15s ease;
}
.photo-remove:hover{transform:scale(1.15);}
.progress-bar-container{
  width:100%;background:#ddd;border-radius:8px;height:16px;margin-top:12px;overflow:hidden;
}
.progress-bar-fill{
  background:linear-gradient(135deg,#00b56a,#00da80);
  height:100%;width:0%;
  transition:width .3s ease;
}
.progress-text{
  text-align:center;font-size:0.85em;color:#333;font-weight:600;margin-top:4px;
}
@media(max-width:700px){
  .wrapper{padding:20px;}
  .photo-thumb{width:80px;height:80px;}
}
</style>
</head>

<body>
<div class="wrapper">
  <h1>WHITE GLOVE SERVICE</h1>
  <h2>Photo documentation</h2>

  <div id="customerHeader">
    <h3>Naƒç√≠t√°m √∫daje z√°kazn√≠ka...</h3>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded",()=>{
    const data=JSON.parse(localStorage.getItem("currentCustomer")||"{}");
    const h=document.getElementById("customerHeader");
    if(data.zakaznik){
      h.innerHTML=`<h3>${data.zakaznik}</h3>
      <p>${data.adresa||""}</p>
      ${data.cislo?`<p>ƒå√≠slo zak√°zky / Order number: <strong>${data.cislo}</strong></p>`:""}`;
    }else{
      h.innerHTML="<h3>Z√°kazn√≠k nebyl nalezen / Customer not found</h3>";
    }
  });
  </script>

  <h4 style="margin-top:30px;">Photo</h4>

  <!-- BLOK 1 -->
  <div class="photo-block">
    <div class="photo-header">
      <h4>P≈ôed opravou<br><span class="subtitle">Before repair</span></h4>
      <button type="button" class="btn-photo" data-section="before">P≈ôidat fotografie / Add photos</button>
    </div>
    <div class="photo-preview" id="preview-before"></div>
  </div>

  <!-- BLOK 2 -->
  <div class="photo-block">
    <div class="photo-header">
      <h4>ID ≈°t√≠tek<br><span class="subtitle">ID label</span></h4>
      <button type="button" class="btn-photo" data-section="id">P≈ôidat fotografie / Add photos</button>
    </div>
    <div class="photo-preview" id="preview-id"></div>
  </div>

  <!-- BLOK 3 -->
  <div class="photo-block">
    <div class="photo-header">
      <h4>Bƒõhem opravy<br><span class="subtitle">During repair</span></h4>
      <button type="button" class="btn-photo" data-section="repair">P≈ôidat fotografie / Add photos</button>
    </div>
    <div class="photo-preview" id="preview-repair"></div>
  </div>

  <!-- BLOK 4 -->
  <div class="photo-block">
    <div class="photo-header">
      <h4>Po opravƒõ<br><span class="subtitle">After repair</span></h4>
      <button type="button" class="btn-photo" data-section="after">P≈ôidat fotografie / Add photos</button>
    </div>
    <div class="photo-preview" id="preview-after"></div>
  </div>

  <input type="file" id="photoInput" accept="image/jpeg,image/png,image/heic" multiple hidden>

  <div class="progress-bar-container">
    <div class="progress-bar-fill" id="progressFill"></div>
  </div>
  <div class="progress-text" id="progressText">0%</div>

<script>
(function(){
  const input=document.getElementById("photoInput");
  const photoSections={before:[],id:[],repair:[],after:[]};
  const fill=document.getElementById("progressFill");
  const text=document.getElementById("progressText");

  document.querySelectorAll(".btn-photo").forEach(btn=>{
    btn.addEventListener("click",()=>{
      input.dataset.section=btn.dataset.section;
      input.click();
    });
  });

  input.addEventListener("change",async()=>{
    const section=input.dataset.section;
    if(!section)return;
    const files=Array.from(input.files).slice(0,10);
    for(const f of files){
      const blob=await compressImage(f);
      const url=URL.createObjectURL(blob);
      photoSections[section].push({blob,url});
    }
    renderPreviews(section);
    input.value="";
  });

  async function compressImage(file,maxDim=180){
    const img=await createImageBitmap(file);
    const canvas=document.createElement("canvas");
    let[w,h]=[img.width,img.height];
    if(w>h&&w>maxDim){h=Math.round(h*(maxDim/w));w=maxDim;}
    else if(h>w&&h>maxDim){w=Math.round(w*(maxDim/h));h=maxDim;}
    canvas.width=w;canvas.height=h;
    const ctx=canvas.getContext("2d");
    ctx.drawImage(img,0,0,w,h);
    return new Promise(r=>canvas.toBlob(r,"image/jpeg",0.85));
  }

  function renderPreviews(section){
    const cont=document.getElementById("preview-"+section);
    cont.innerHTML="";
    photoSections[section].forEach((p,i)=>{
      const wrap=document.createElement("div");
      wrap.style.position="relative";
      const img=document.createElement("img");
      img.src=p.url;
      img.className="photo-thumb";
      const btn=document.createElement("button");
      btn.className="photo-remove";
      btn.textContent="√ó";
      btn.onclick=()=>{
        photoSections[section].splice(i,1);
        renderPreviews(section);
      };
      wrap.append(img,btn);
      cont.append(wrap);
    });
  }

  async function uploadAll(){
    const allPhotos=Object.values(photoSections).flat();
    if(!allPhotos.length)return alert("Nen√≠ vybr√°na ≈æ√°dn√° fotografie / No photos selected.");
    let uploaded=0;
    const total=allPhotos.length;
    for(const p of allPhotos){
      await fakeUpload(p);
      uploaded++;
      const pct=Math.round((uploaded/total)*100);
      fill.style.width=pct+"%";
      text.textContent=pct+"%";
    }
  }
  async function fakeUpload(){return new Promise(r=>setTimeout(r,250));}
  window.uploadAll=uploadAll;
})();
</script>
<!-- üü© KONEC ƒå√ÅSTI 1/2 -->
<!-- üü© ZAƒå√ÅTEK ƒå√ÅSTI 2/2 ‚Äì SEKCE 6‚Äì10 -->

<!-- üü® SEKCE 6 ‚Äì ODESL√ÅN√ç FOTODOKUMENTACE -->
<div class="actions" style="text-align:center;margin-top:25px;">
  <button type="button" id="btnUploadAll" class="btn-send">Nahr√°t v≈°echny fotografie / Upload all photos</button>
</div>

<div class="wait-overlay" id="waitOverlay">
  <div class="hourglass"></div>
  <p>Prob√≠h√° nahr√°v√°n√≠ fotografi√≠ / Uploading photos‚Ä¶</p>
</div>

<style>
.btn-send{
  background:linear-gradient(135deg,#00b56a,#00da80);
  color:#fff;font-weight:600;
  border:none;border-radius:8px;
  padding:12px 28px;cursor:pointer;
  font-size:1em;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  transition:transform .15s ease,opacity .2s;
}
.btn-send:hover{transform:scale(1.05);opacity:.9;}
.wait-overlay{
  display:none;position:fixed;inset:0;
  background:rgba(255,255,255,0.85);
  backdrop-filter:blur(2px);
  justify-content:center;align-items:center;
  flex-direction:column;
  font-weight:600;color:#333;
  z-index:2000;
}
.wait-overlay.active{display:flex;}
.hourglass{
  border:4px solid #ccc;border-top:4px solid #00b56a;
  border-radius:50%;width:40px;height:40px;
  animation:spin 1s linear infinite;margin-bottom:10px;
}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
</style>

<script>
(function(){
const uploadBtn=document.getElementById("btnUploadAll");
const wait=document.getElementById("waitOverlay");
uploadBtn.addEventListener("click",async()=>{
  wait.classList.add("active");
  await window.uploadAll();
  wait.classList.remove("active");
  alert("‚úÖ Fotky byly nahr√°ny / Photos uploaded successfully");
});
})();
</script>
<!-- üü® KONEC SEKCE 6 -->



<!-- üü® SEKCE 7 ‚Äì ULO≈ΩEN√â FOTOGRAFIE -->
<h3 style="margin-top:40px;">Ulo≈æen√© fotografie / Saved photos</h3>
<p style="font-size:0.85em;color:#555;">Zde se zobraz√≠ fotky po nahr√°n√≠ / Photos will appear after upload.</p>

<div id="savedPhotos" class="saved-photos">
  <div class="placeholder">üì∑ Zat√≠m ≈æ√°dn√© fotografie / No photos yet.</div>
</div>

<style>
.saved-photos{
  border:1px solid #ddd;border-radius:10px;
  background:#fafafa;margin-top:12px;padding:15px;
}
.placeholder{text-align:center;color:#777;font-size:0.9em;padding:20px 0;}
</style>
<!-- üü® KONEC SEKCE 7 -->



<!-- üü® SEKCE 8 ‚Äì NOTIFIKACE -->
<div id="notif" class="notif"></div>
<style>
.notif{
  position:fixed;top:15px;left:50%;
  transform:translateX(-50%);
  min-width:260px;max-width:90%;
  padding:12px 20px;border-radius:10px;
  font-weight:600;font-size:0.9em;
  color:#fff;text-align:center;
  box-shadow:0 4px 10px rgba(0,0,0,0.15);
  opacity:0;pointer-events:none;
  z-index:9999;transition:opacity .3s,transform .3s;
}
.notif.show{opacity:1;transform:translateX(-50%) translateY(0);}
.notif.success{background:linear-gradient(135deg,#00b56a,#00da80);}
.notif.warning{background:linear-gradient(135deg,#ffb200,#ffca40);color:#333;}
.notif.error{background:linear-gradient(135deg,#e63946,#ff6b6b);}
</style>

<script>
(function(){
const n=document.getElementById("notif");
let t=null;
window.showNotif=function(type="success",text="Ulo≈æeno / Saved"){
  n.className=`notif ${type}`;n.textContent=text;n.classList.add("show");
  clearTimeout(t);t=setTimeout(()=>n.classList.remove("show"),2500);
};
})();
</script>
<!-- üü® KONEC SEKCE 8 -->



<!-- üü® SEKCE 9 ‚Äì OVL√ÅDAC√ç TLAƒå√çTKA Z√ÅVƒöR -->
<div class="actions" style="margin-top:40px;text-align:center;">
  <a href="index.html" class="btn-back">Zpƒõt na menu / Back to menu</a>
  <button type="button" id="btnReloadData" class="btn-gray">Naƒç√≠st ulo≈æen√© / Reload</button>
</div>

<style>
.btn-back{
  background:linear-gradient(135deg,#9b9b9b,#bfbfbf);
  color:#fff;font-weight:600;border:none;border-radius:8px;
  padding:12px 28px;cursor:pointer;font-size:1em;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  transition:transform .15s ease,opacity .2s;
  text-decoration:none;display:inline-flex;align-items:center;justify-content:center;
}
.btn-gray{
  background:linear-gradient(135deg,#6c757d,#a0a4a7);
  color:#fff;font-weight:600;border:none;border-radius:8px;
  padding:12px 28px;cursor:pointer;font-size:1em;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  transition:transform .15s ease,opacity .2s;
}
.btn-back:hover,.btn-gray:hover{transform:scale(1.05);opacity:.9;}
</style>

<script>
document.getElementById("btnReloadData").addEventListener("click",()=>{
  showNotif("warning","Obnovuji / Reloading‚Ä¶");
  setTimeout(()=>location.reload(),800);
});
</script>
<!-- üü® KONEC SEKCE 9 -->


<footer style="text-align:center;margin:30px 0 20px;font-size:0.8em;color:#888;">
  White Glove Service s.r.o. ‚Ä¢ ¬© 2025
</footer>

</div> <!-- wrapper -->
</body>
</html>
<!-- üü© KONEC ƒå√ÅSTI 2/2 ‚Äì FINAL -->
