<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>White Glove Service</title>
  <style>
    :root {
      font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      color: #111;
    }
    body { margin:0; padding:0; background:#f6f7fb; }
    .screen { display:none; min-height:100vh; padding:20px; }
    .active { display:block; }

    /* Úvodní obrazovka */
    .home {
      display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;
    }
    .home h1 {
      font-size:3.5em;       /* větší */
      font-weight:900;       /* extra tučný */
      margin:0 0 15px;
    }
    .home p {
      font-size:1.3em;
      margin:0 0 40px;
      color:#555;
    }
    .btn {
      background:#e0e0e0;        /* světle šedé tlačítko */
      color:#111;
      padding:15px 30px;
      margin:10px;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-size:1.1em;
      min-width:220px;           /* stejná šířka */
      box-shadow:0 2px 5px rgba(0,0,0,0.15);  /* jemný stín */
      transition:0.2s;
    }
    .btn:hover {
      background:#d5d5d5;        /* mírné stmavení při hoveru */
    }

    /* Seznam */
    input[type="text"] {
      padding:8px; border-radius:6px; border:1px solid #ccc; width:100%; max-width:400px;
    }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    table th, table td { border:1px solid #ccc; padding:8px; text-align:left; font-size:0.9em; }
    table th { background:#eee; }

    /* Protokol */
    .form-group { margin-bottom:12px; }
    label { display:block; font-weight:bold; margin-bottom:4px; }
    input, textarea {
      width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; font-size:0.95em;
    }
    #signature { border:1px solid #ccc; background:#fff; width:100%; height:200px; }
  </style>
</head>
<body>

<!-- Úvodní obrazovka -->
<div id="home" class="screen home active">
  <h1>WHITE GLOVE SERVIS</h1>
  <p>specializovaný autorizovaný servis Natuzzi</p>
  <button class="btn" onclick="showScreen('list')">Seznam reklamací</button>
  <button class="btn" onclick="showScreen('protocol')">Protokol oprav</button>
</div>

<!-- Seznam reklamací -->
<div id="list" class="screen">
  <h2>Seznam reklamací</h2>
  <input type="text" id="search" placeholder="Hledat jméno, adresu, telefon, objednávku...">
  <div id="results">Načítám data...</div>
  <button class="btn" onclick="showScreen('home')">Zpět</button>
</div>

<!-- Protokol oprav -->
<div id="protocol" class="screen">
  <h2>Protokol oprav</h2>
  <form id="repairForm">
    <div class="form-group">
      <label>Zákazník</label>
      <input type="text" name="customer">
    </div>
    <div class="form-group">
      <label>Adresa</label>
      <input type="text" name="address">
    </div>
    <div class="form-group">
      <label>Popis závady / opravy</label>
      <textarea name="description"></textarea>
    </div>
    <div class="form-group">
      <label>Podpis zákazníka</label>
      <canvas id="signature"></canvas><br>
      <button type="button" class="btn" onclick="clearSignature()">Vymazat podpis</button>
    </div>
  </form>
  <button class="btn" onclick="exportPDF()">Exportovat do PDF</button>
  <button class="btn" onclick="showScreen('home')">Zpět</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// podpis (canvas)
let canvas = document.getElementById("signature");
let ctx = canvas.getContext("2d");
let drawing = false;
canvas.addEventListener("mousedown", e => {drawing=true; ctx.beginPath(); ctx.moveTo(e.offsetX,e.offsetY);});
canvas.addEventListener("mousemove", e => {if(drawing){ctx.lineTo(e.offsetX,e.offsetY); ctx.stroke();}});
canvas.addEventListener("mouseup", ()=> drawing=false);
canvas.addEventListener("mouseleave", ()=> drawing=false);
function clearSignature(){ ctx.clearRect(0,0,canvas.width,canvas.height); }

// Export do PDF
async function exportPDF(){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  const element = document.getElementById("repairForm");
  const canvasEl = await html2canvas(element);
  const imgData = canvasEl.toDataURL("image/png");
  pdf.addImage(imgData, 'PNG', 10, 10, 190, 0);
  pdf.save("protokol.pdf");
}

// --- SEZNAM REKLAMACÍ ---
const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQzpP83wIYZPcnb1NI9pPSPixzcEQuRVrTOyPD7SRbgYZSrQs7QdcLNwPJ5lQleGbVVK29nr2-bMo6Y/pub?gid=0&single=true&output=csv";

let allData = [];
async function loadData() {
  try {
    const res = await fetch(sheetUrl);
    const text = await res.text();
    allData = text.split("\n").map(r => r.split(","));
    renderTable(allData.slice(1)); // bez hlavičky
  } catch (err) {
    document.getElementById("results").innerHTML = "Chyba při načítání dat: " + err;
  }
}

function renderTable(rows){
  if (!rows.length){ document.getElementById("results").innerHTML = "Žádná data"; return; }
  let html = "<table><tr>";
  allData[0].forEach(h => { html += "<th>"+h+"</th>"; });
  html += "</tr>";
  rows.forEach(r => {
    html += "<tr>";
    r.forEach(c => { html += "<td>"+c+"</td>"; });
    html += "</tr>";
  });
  html += "</table>";
  document.getElementById("results").innerHTML = html;
}

// vyhledávání
document.getElementById("search").addEventListener("input", e => {
  const q = e.target.value.toLowerCase();
  const rows = allData.slice(1).filter(r => r.join(" ").toLowerCase().includes(q));
  renderTable(rows);
});

// načti data při startu
loadData();
</script>

</body>
</html>
